<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Aby George A</title>
  <meta name="author" content="Aby George A">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.abygeorgea.com/posts/2/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Aby George A" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.abygeorgea.com/posts/2/">
  <meta property="og:title" content="Aby George A">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-99127431-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Aby George A</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
				<li >
                    <a href="/about">About Me</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.abygeorgea.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Aby George A" />
    
    <meta itemprop="url" content="http://www.abygeorgea.com" />
      
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-09-06T22:00:23+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 6 Sep, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/09/06/how-to-take-screenshots-with-selenium-in-c/" itemprop="url">How to Take Screenshots With Selenium in C#</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Very frequently testers will meet a situation where they need to take screenshot of webpage they are testing , either for base line or as a proof of test result. This is same with automated testing . Even though automated test cases have their own of way of publishing test results, it is always desirable to keep a proof of result.. Screenshot come to help in this regards. In this blog post , I will explain , how to take a screenshot with Selenium Web Driver with C#. In future I will add another couple of post to explain , how to consolidate the screenshots into a PDF document.</p>

<p>In .NET binding, we have an interface called ITakesScreenshot , which helps to capture screenshot of active window. Below code will help to take screenshot and save it in the path specified while calling the function</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>// PathToFolder is the location where we need to save the screenshot
</span><span class='line'>// FileName is another string where PathToFolder is appended with timestamp
</span><span class='line'>public void TakeScreenShot(string PathToFolder)
</span><span class='line'>{
</span><span class='line'>  string fileName = PathToFolder + DateTime.Now.ToString("HHmmss") +".jpeg";
</span><span class='line'>  Screenshot cp = ((ITakesScreenshot)driver).GetScreenshot();
</span><span class='line'>  cp.SaveAsFile(fileName, System.Drawing.Imaging.ImageFormat.Jpeg);
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-09-04T08:33:04+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 4 Sep, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/09/04/element-location-using-xpath-axis/" itemprop="url">Element Location Using XPath Axis</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>During testing we will sometimes come up to situations where developers are not following best practises for testability . We will frequently come up situations where elements doesn&rsquo;t have any unique identifiable property. XPath axis comes to help in those situations. We can identify elements using various XPath Properties</p>

<p>List of various XPath Axis are available in <a href="https://developer.mozilla.org/en-US/docs/Web/XPath/Axes">https://developer.mozilla.org/en-US/docs/Web/XPath/Axes</a>
If you have well-defined properties to identify the element, use them as your locator. Please read  locator strategy  <a href="/blog/2016/08/30/element-location-using-xpath/">Using XPath</a> and <a href="/blog/2016/08/17/identifying-elements-using-locators-in-selenium/">Other Parameters</a></p>

<p>Below are major one&rsquo;s which we will frequently use</p>

<h3>1. ancestor</h3>

<p>This selects all ancestors of current node. That will include parent, grand parents etc
Eg :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> //td[text()='Product Desc']/ancestor::tr</span></code></pre></td></tr></table></div></figure>


<h3>2. descendant</h3>

<p>This selects all children of current node. That will include child, grand child etc
Eg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/table/descendant::td/input</span></code></pre></td></tr></table></div></figure>


<h3>3. followingis</h3>

<p>Th selects everything after the closing tag of current node Eg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//td[text()='Product Desc']/following::tr</span></code></pre></td></tr></table></div></figure>


<h3>4. following-sibling</h3>

<p>This selects all siblings after the closing tah of current node.
Eg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//td[text()='Product Desc']/followingsibling::td</span></code></pre></td></tr></table></div></figure>


<h3>5. preceding</h3>

<p>This selects everything prior to current node
Eg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> //td[text()='Add to cart']/preceding::tr</span></code></pre></td></tr></table></div></figure>


<ol>
<li>preceding-sibling</li>
</ol>


<p>This selects all siblings prior to current node
Eg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//td[text()='Add to cart']/precedingsibling::td</span></code></pre></td></tr></table></div></figure>


<h3>7. child</h3>

<p>This selects all children of current node</p>

<h3>8. parent</h3>

<p>This select parent of current node</p>

<p>As usual , you can always use combinations of above in your test. Statements can be constructed in the same way as we traverse the XPath axis</p>

<p>Last , but not least&hellip; we can also use regular expression in XPath.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-08-30T20:58:16+10:00"  data-updated="true" itemprop="datePublished dateCreated">30 Aug, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/08/30/element-location-using-xpath/" itemprop="url">Element Location Using XPath</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>XPath is XML query language which can be used for selecting nodes in XML. Hence it can be used to identify elements from DOM since they are represented as XHTML documents. Selenium WebDriver also supports XPath for locating elements. They also help to look for elements in both direction and hence it is generally slow compared to all other locator strategy. We can use XPath with both absolute path and relative path.</p>

<h4><strong>Absolute XPath</strong></h4>

<p>Absolute Path refers to specific location in DOM, by considering it&rsquo;s complete hierarchy. However this is not an ideal locator strategy since it makes your test very brittle. The absolute path will change if there is any change/realignment etc in UI.</p>

<p>Example of Xpath using absolute path is as below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>WebElement userId = driver.FindElement(By.XPath(html/body/div[2]/div/form/input[2]));
</span></code></pre></td></tr></table></div></figure>


<h4><strong>Relative XPath</strong></h4>

<p>With relative Path , we can find element directly without entire structure. It helps to look out for any elements which matches with specified relative path . Example for a relative path based locator strategy is as below.</p>

<p>Note: Relative XPath starts with &ldquo;//&rdquo;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>WebElement userId = driver.FindElement(By.XPath("//input"));
</span><span class='line'>// This retrieve first element with input tag.
</span><span class='line'>WebElement userId = driver.FindElement(By.XPath("//input[2]"));
</span><span class='line'>// This retrieve second element with input tag.
</span></code></pre></td></tr></table></div></figure>


<h4><strong>Relative XPath  - With Attributes</strong></h4>

<p>If we need to further narrow down our location strategy, we can use Attributes along with relative XPath. There may be situations where we need to multiple attributes to uniquely identify an element. We can also specify locators to identify for ANY attribute</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>WebElement passwordField = driver.FindElement(By.XPath("//input[@id='password']"));
</span><span class='line'>// Above will identify first element with input tag which also has id as "password".
</span><span class='line'>
</span><span class='line'>WebElement LoginButton = driver.FindElement(By.XPath("//input[@type='submit'and @value='Login']"));
</span><span class='line'>//Note you can use "or" as well.
</span><span class='line'>WebElement someField = driver.FindElement(By.XPath("//input[@*='password']"));
</span><span class='line'>// Above will identify first element with input tag which also has any attribute as "password".</span></code></pre></td></tr></table></div></figure>


<h4><strong>Relative XPath - Partial Match</strong></h4>

<p>Sometimes there may be situations where element attributes like ID are dynamically generated. Those will generally have some unique part in attributes likeID and
remaining will be generated dynamically , which will keep on changing. This will need a locator strategy which will help us to identify elements using partial match. Main types are</p>

<ul>
<li><p>starts-with()</p></li>
<li><p>ends-with()</p></li>
<li><p>contains()</p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>WebElement passwordField1 = driver.FindElement(By.XPath("//input[starts-with(@id,'password')]"));
</span><span class='line'>// Above will identify first element with input tag which also has id starting with "password".
</span><span class='line'>WebElement passwordField2 = driver.FindElement(By.XPath("//input[ends-with(@id,'password')]"));
</span><span class='line'>// Above will identify first element with input tag which also has id ending with "password".
</span><span class='line'>
</span><span class='line'>WebElement passwordField3 = driver.FindElement(By.XPath("//input[contains(@id,'password')]"));
</span><span class='line'>// Above will identify first element with input tag which also has id containing with "password".</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-08-18T06:30:54+10:00"  data-updated="true" itemprop="datePublished dateCreated">18 Aug, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/08/18/identifying-elements-using-locators-in-selenium/" itemprop="url">Identifying Elements Using Locators in Selenium</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Locators are html properties of a web element , which can be considered as an address of the element. An element will have various html properties. We can use Firebug extension or Chrome dev tools to identify different locators of an element.</p>

<p>Selenium Web Driver provides two different methods for identifying html elements .</p>

<ul>
<li><p><em><strong>FindElement  </strong></em>for WebDriver and WebElement Class. When locating element matching specified criteria, it looks through DOM( Document Object Model) for matching element and return the first matching element. If there are no matching element, it will throw NoSuchElementFoundException</p></li>
<li><p><em><strong>FindElements</strong> </em>for WebDriver and WebElement Class. When locating element matching specified criteria, it looks through DOM( Document Object Model) for matching element and return a list of all matching element. If there are no matching elements, then it will return an empty list .</p></li>
</ul>


<p>Note: Both of them doesn&rsquo;t support regular expression for finding element. Simple way to do that will be to get list of all elements and then iterate to find a matching regular expression</p>

<p>There are multiple criteria which we can use for looking for an element. FindElement and FindElements work exactly same way except for above difference. Different critieria are</p>

<ul>
<li><p>driver.FindElement(By.Id(<elementID>))</p></li>
<li><p>driver.FindElement(By.Name(<element name>))</p></li>
<li><p>driver.FindElement(By.ClassName(<element class>))</p></li>
<li><p>driver.FindElement(By.TagName(<htmltagname>))</p></li>
<li><p>driver.FindElement(By.LinkText(<linktext >))</p></li>
<li><p>driver.FindElement(By.PartialLinkText(<linktext >))</p></li>
<li><p>driver.FindElement(By.CssSelector(<css selector >))</p></li>
<li><p>driver.FindElement(By.XPath(<xpath query expression>))</p></li>
</ul>


<p>Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>WebElement _firstElement = driver.findElement(By.id("div1"));
</span><span class='line'>WebElement _secondElementInsideFirstOne =_firstElement .findElement(By.linkText("username"));
</span><span class='line'>
</span><span class='line'>IList&lt;IWebElement&gt; elements = driverOne.FindElements(By.ClassName(&lt;span class="pl-s"&gt;&lt;span class="pl-pds"&gt;“&lt;/span&gt;green&lt;span class="pl-pds"&gt;“&lt;/span&gt;&lt;/span&gt;));
</span></code></pre></td></tr></table></div></figure>


<p>Using any attributes other than XPath and CssSelector are straight forward. More about using XPath and CssSelector in next blog.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-08-01T12:12:23+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 1 Aug, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/08/01/specflow-sharing-data-between-steps/" itemprop="url">Specflow - Sharing Data Between Steps</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>In Specflow, Step definitions are global. So a scenario can have multiple step definitions which can be present in different classes.  Sometimes, there arise a need to share the data between steps residing in different classes. How do we do it??</p>

<p>There are multiple ways to do it</p>

<ol>
<li><p>Context Injection</p></li>
<li><p>Feature Context</p></li>
<li><p>Scenario Context</p></li>
</ol>


<p>Let us look into more details about how to store and retrieve data using Scenario Context .</p>

<p><strong>ScenarioContext.Current</strong></p>

<p>How do we add a key value pair to Scenario Context ? It is as simple as below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Given(@"I have entered (.*) and (.*) into the Login Page")]
</span><span class='line'>public void GivenIHaveEnteredAndIntoTheLoginPage(string p0, string p1)
</span><span class='line'> {
</span><span class='line'> ScenarioContext.Current.Add("username", p0);
</span><span class='line'> ScenarioContext.Current.Add("password", p1);
</span><span class='line'> }</span></code></pre></td></tr></table></div></figure>


<p>How do we retrieve the value from ScenarioContext ?</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>When(@"I press retrieve data")]
</span><span class='line'>public void WhenIRetrieveData()
</span><span class='line'>{
</span><span class='line'>string username = (string)ScenarioContext.Current["username"];
</span><span class='line'>string password = (string)ScenarioContext.Current["password"];
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Note: While retrieving , scenarioContext.Current always return an object . Hence we need use explicit casting while retrieving data from scenario context.</p>

<p>In Nut Shell,</p>

<blockquote>**Set a value for a key ( Store data ) **
ScenarioContext.Current.Add(string key, object value);

**Get a value of the key ( Retrieve data) **
var value =(Type) ScenarioContext.Current.[string Key];

var value = ScenarioContext.Current.Get(string Key);</blockquote>


<p>We can use this for storing and passing objects as well</p>

<blockquote>Example of storing webdriver object is as below.(where "browser" is current webdriver object )

ScenarioContext.Current.Add("driver1", browser);

IWebDriver driver2 = (IWebDriver)ScenarioContext.Current["driver1"];</blockquote>

</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-07-30T08:10:02+10:00"  data-updated="true" itemprop="datePublished dateCreated">30 Jul, 2016</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2016/07/30/data-driven-framework-xml/" itemprop="url">Data Driven Framework - XML</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>I am not going to explain what is data driven framework or what is its benefits.  All of them are pretty well-known . If not, just google it.</p>

<p>Here I am going to explain a sample code which can be used to read from xml data files. This will be helpful to implement a data driven frame work for BDD testing , using Specflow or Cucumber</p>

<h2>Pre - requiste</h2>

<p>Code is written in Csharp . We need to add below reference to visual studio solution</p>

<ol>
<li><p>Add reference to System.xml</p></li>
<li><p>Add reference to System.Xml.Linq</p></li>
</ol>


<h2><strong>XML Format</strong></h2>

<p>[code language=&ldquo;xml&rdquo; ]</p>

<p>[/code]</p>

<p>Node names in above example are Scenario1, Scenario2 and Scenario3</p>

<p>Element or Attribute name are username, password, Email .</p>

<p>You can add any number of nodes and attributes depending on the test scenario</p>

<h2><strong>Read specific Value from XML</strong></h2>

<p>Below code provides a solution to read values of existing Key/Attribute from a specific node.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public static string ReadDataFromXML(string FileName, string NodeName, string KeyName)
</span><span class='line'>{
</span><span class='line'> string _basePath = AppDomain.CurrentDomain.BaseDirectory.ToString();
</span><span class='line'>string _datafilePath = _basePath + @"..\..\Data\" + FileName;
</span><span class='line'>XDocument xmlDoc = XDocument.Load(_datafilePath);
</span><span class='line'>data = xmlDoc.Root.Element(NodeName).Attribute(KeyName).Value;
</span><span class='line'>return data;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p> </p>

<h2>Read All values for a Scenario from XML</h2>

<p>This code gives a solution for reading details of all attributes/key from a node. This comes very handy for reading all data required for a scenario and adding them to scenario context , so that data can be shared across specflow/cucumber step definitions</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public static void ReadAllDataFromXml(string xFileName, string xNodeName)
</span><span class='line'>{
</span><span class='line'> string data = string.Empty;
</span><span class='line'>// Load path of xml file . Data Folder in below is folder name
</span><span class='line'>string _basePath = AppDomain.CurrentDomain.BaseDirectory.ToString();
</span><span class='line'>string _datafilePath = _basePath + @"..\..\Data\" + xFileName;
</span><span class='line'>XDocument xmlDoc = XDocument.Load(_datafilePath);
</span><span class='line'>
</span><span class='line'>var cols = xmlDoc.Descendants(xNodeName).First();
</span><span class='line'>
</span><span class='line'>foreach (XAttribute xAtt in cols.Attributes())
</span><span class='line'>{
</span><span class='line'>Console.WriteLine("{0},{1}", xAtt.Name, xAtt.Value); // --printing values --
</span><span class='line'>string temp = xAtt.Name.ToString();
</span><span class='line'>ScenarioContext.Current.Add(temp, xAtt.Value);
</span><span class='line'>// The values are added to scenario context as key value pair.can be modified
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Write Data into XML</h2>

<p>  Below function gives a solution to update value on an existing key/attribute in data sheet . Sometime the data sheet will be copied over to bin folder when we build the solution. That makes it necessary to update both original data sheet and the one in bin folder  so that modified data can be used in same test without another rebuild.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public void WriteIntoXML(string xData, string xElement, string xAttribute, string xFileName)
</span><span class='line'>{
</span><span class='line'> // This solution updates value of an existing key.
</span><span class='line'> // Xdoc refers to the xmlsheet in the Solution explorer
</span><span class='line'> // xDoc_2 refers to the xmlsheet inside bin folder while running
</span><span class='line'>
</span><span class='line'> // This solution write them separately in below code.
</span><span class='line'> // Below is the path to xml file after building solution
</span><span class='line'> XDocument xDoc_2 = XDocument.Load(Path.Combine(Environment.CurrentDirectory, "Data Folder", xFileName));
</span><span class='line'>
</span><span class='line'> //Below should be the path of xml file
</span><span class='line'> XDocument xDoc = XDocument.Load(Path.Combine(Path.GetFullPath(@"../../Data Folder"), xFileName));
</span><span class='line'> xDoc_2.Root.Element(xElement).Attribute(xAttribute).Value = data.ToString();
</span><span class='line'> xDoc.Root.Element(xElement).Attribute(xAttribute).Value = data.ToString();
</span><span class='line'> xDoc_2.Save(Path.Combine(Environment.CurrentDirectory, "Data Folder", xFileName));
</span><span class='line'> xDoc.Save(Path.Combine(Path.GetFullPath(@"../../Data Folder"), xFileName));
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>



</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-05-21T07:41:32+10:00"  data-updated="true" itemprop="datePublished dateCreated">21 May, 2014</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2014/05/21/hello-world/" itemprop="url">Hello World</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p><a href="/blog/2016/09/04/element-location-using-xpath-axis/">Redirect</a></p>
</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous disabled"><a href="#">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next"><a href="/index.html">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/data-driven-testing-framework/index.html">
        <span class="badge">2</span>
        data driven testing framework
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium-webdriver/index.html">
        <span class="badge">2</span>
        selenium webdriver
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/xml/index.html">
        <span class="badge">1</span>
        xml
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/specflow/index.html">
        <span class="badge">4</span>
        specflow
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/bdd/index.html">
        <span class="badge">1</span>
        bdd
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/element-identification/index.html">
        <span class="badge">3</span>
        element identification
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium/index.html">
        <span class="badge">3</span>
        selenium
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/git/index.html">
        <span class="badge">2</span>
        git
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/powershell/index.html">
        <span class="badge">2</span>
        powershell
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/mountebank/index.html">
        <span class="badge">5</span>
        mountebank
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualisation/index.html">
        <span class="badge">5</span>
        service virtualisation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octopress/index.html">
        <span class="badge">1</span>
        octopress
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octostrap3/index.html">
        <span class="badge">1</span>
        octostrap3
      </a>
    
  </div>
</section><section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2017/06/15/how-to-squash-commits-in-git/">How to Squash Commits in Git</a>
    
    <a class="list-group-item " href="/blog/2017/05/20/migrating-to-octopress/">Migrating to Octopress</a>
    
    <a class="list-group-item " href="/blog/2017/05/02/powershell-remove-entire-directory-and-its-content/">Powershell - Remove Entire Directory and It's Content</a>
    
    <a class="list-group-item " href="/blog/2017/04/27/stubbing-xml-responses-using-mountebank/">Stubbing XML Responses Using Mountebank</a>
    
    <a class="list-group-item " href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">Mountebank - Creating a Response Based on a File Template and Modifying It Based on Request - PART 2</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'abygeorgea',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2017 - Aby George A<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


	
  </body>
</html>
