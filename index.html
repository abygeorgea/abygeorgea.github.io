<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Aby George A</title>
  <meta name="author" content="Aby George A">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.abygeorgea.com/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Aby George A" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.abygeorgea.com/">
  <meta property="og:title" content="Aby George A">
  <meta property="og:description" content="My thoughts on Test Automation . This blog is mainly for documenting my learning on Test automation . I intend to have this as a go to location for finding solutions for the problem faced by me in &hellip;">

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-99127431-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Aby George A</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
				<li >
                    <a href="/resources">Resources</a>
                </li>
				<li >
                    <a href="/about">About Me</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.abygeorgea.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Aby George A" />
    <meta itemprop="description" content="My thoughts on Test Automation . This blog is mainly for documenting my learning on Test automation . I intend to have this as a go to location for finding solutions for the problem faced by me in past . Hopefully this will help others as well." />
    <meta itemprop="url" content="http://www.abygeorgea.com" />
      
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-09-08T21:47:52+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 8 Sep, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/09/08/running-command-line-in-remote-machine-using-wmi/" itemprop="url">Running Command Line in Remote Machine Using WMI</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Recently I had to find a way for running a command line process in server. I had to spend fair bit of time googling for various approaches of doing it. Most of them are by using PSExec.  However there is another approach of using WMI (Windows Management Instrumentation) . Below is one of the approach , which I found at <a href="https://blogs.msdn.microsoft.com/padmanr/2010/05/08/execute-a-process-on-remote-machine-wait-for-it-to-exit-and-retrieve-its-exit-code-using-wmi/">msdn blog</a>.</p>

<p>Below method can be accessed anywhere by</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ProcessWMI p = new ProcessWMI();
</span><span class='line'>p.ExecuteRemoteProcessWMI(remoteMachine, sBatFile, timeout);</span></code></pre></td></tr></table></div></figure>


<p>The solution has multiple parts as follows</p>

<ol>
<li>Connect to remote machine using remote machine Name, user name and password</li>
<li>Start the remote process. Win32 process and pass the command to be run</li>
<li>Find if the remote process is running and if it does, start an event monitor to wait for it to exit</li>
<li>Once the process exits, retrieve its exit code</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
</pre></td><td class='code'><pre><code class='Csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">ProcessWMI</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">uint</span> <span class="n">ProcessId</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">ExitCode</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">EventArrived</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">ManualResetEvent</span> <span class="n">mre</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManualResetEvent</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessStoptEventArrived</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArrivedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">((</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ProcessId&quot;</span><span class="p">].</span><span class="n">Value</span> <span class="p">==</span> <span class="n">ProcessId</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Process: {0}, Stopped with Code: {1}&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ProcessId&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ExitStatus&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
</span><span class='line'>            <span class="n">ExitCode</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ExitStatus&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span>
</span><span class='line'>            <span class="n">EventArrived</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>            <span class="n">mre</span><span class="p">.</span><span class="n">Set</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">ProcessWMI</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">ProcessId</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="n">ExitCode</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
</span><span class='line'>        <span class="n">EventArrived</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">ExecuteRemoteProcessWMI</span><span class="p">(</span><span class="kt">string</span> <span class="n">remoteComputerName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arguments</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WaitTimePerCommand</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">string</span> <span class="n">strUserName</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span><span class='line'>        <span class="k">try</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">ConnectionOptions</span> <span class="n">connOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ConnectionOptions</span><span class="p">();</span>
</span><span class='line'>            <span class="c1">//Note: This will connect  using below credentials. If not provided, it will be based on logged in user</span>
</span><span class='line'>             <span class="n">connOptions</span><span class="p">.</span><span class="n">Username</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineLogonUser&quot;</span><span class="p">];</span>
</span><span class='line'>             <span class="n">connOptions</span><span class="p">.</span><span class="n">Password</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineUserPassword&quot;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">connOptions</span><span class="p">.</span><span class="n">Impersonation</span> <span class="p">=</span> <span class="n">ImpersonationLevel</span><span class="p">.</span><span class="n">Impersonate</span><span class="p">;</span>
</span><span class='line'>            <span class="n">connOptions</span><span class="p">.</span><span class="n">EnablePrivileges</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>            <span class="n">ManagementScope</span> <span class="n">manScope</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementScope</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">@&quot;\\{0}\ROOT\CIMV2&quot;</span><span class="p">,</span> <span class="n">remoteComputerName</span><span class="p">),</span> <span class="n">connOptions</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">try</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">manScope</span><span class="p">.</span><span class="n">Connect</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Management Connect to remote machine &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span> <span class="p">+</span> <span class="s">&quot; as user &quot;</span> <span class="p">+</span> <span class="n">strUserName</span> <span class="p">+</span> <span class="s">&quot; failed with the following error &quot;</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">ObjectGetOptions</span> <span class="n">objectGetOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectGetOptions</span><span class="p">();</span>
</span><span class='line'>            <span class="n">ManagementPath</span> <span class="n">managementPath</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementPath</span><span class="p">(</span><span class="s">&quot;Win32_Process&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementClass</span> <span class="n">processClass</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementClass</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">managementPath</span><span class="p">,</span> <span class="n">objectGetOptions</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementBaseObject</span> <span class="n">inParams</span> <span class="p">=</span> <span class="n">processClass</span><span class="p">.</span><span class="n">GetMethodParameters</span><span class="p">(</span><span class="s">&quot;Create&quot;</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">inParams</span><span class="p">[</span><span class="s">&quot;CommandLine&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">arguments</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">using</span> <span class="p">(</span><span class="n">ManagementBaseObject</span> <span class="n">outParams</span> <span class="p">=</span> <span class="n">processClass</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">(</span><span class="s">&quot;Create&quot;</span><span class="p">,</span> <span class="n">inParams</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>                        <span class="k">if</span> <span class="p">((</span><span class="kt">uint</span><span class="p">)</span><span class="n">outParams</span><span class="p">[</span><span class="s">&quot;returnValue&quot;</span><span class="p">]</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">{</span>
</span><span class='line'>                            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Error while starting process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; creation returned an exit code of &quot;</span> <span class="p">+</span> <span class="n">outParams</span><span class="p">[</span><span class="s">&quot;returnValue&quot;</span><span class="p">]</span> <span class="p">+</span> <span class="s">&quot;. It was launched as &quot;</span> <span class="p">+</span> <span class="n">strUserName</span> <span class="p">+</span> <span class="s">&quot; on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                        <span class="k">this</span><span class="p">.</span><span class="n">ProcessId</span> <span class="p">=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">outParams</span><span class="p">[</span><span class="s">&quot;processId&quot;</span><span class="p">];</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">SelectQuery</span> <span class="n">CheckProcess</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="s">&quot;Select * from Win32_Process Where ProcessId = &quot;</span> <span class="p">+</span> <span class="n">ProcessId</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectSearcher</span> <span class="n">ProcessSearcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementObjectSearcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">CheckProcess</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectCollection</span> <span class="n">MoC</span> <span class="p">=</span> <span class="n">ProcessSearcher</span><span class="p">.</span><span class="n">Get</span><span class="p">())</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">MoC</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;ERROR AS WARNING: Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; terminated before it could be tracked on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">WqlEventQuery</span> <span class="n">q</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WqlEventQuery</span><span class="p">(</span><span class="s">&quot;Win32_ProcessStopTrace&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementEventWatcher</span> <span class="n">w</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementEventWatcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">w</span><span class="p">.</span><span class="n">EventArrived</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventArrivedEventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ProcessStoptEventArrived</span><span class="p">);</span>
</span><span class='line'>                <span class="n">w</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(!</span><span class="n">mre</span><span class="p">.</span><span class="n">WaitOne</span><span class="p">(</span><span class="n">WaitTimePerCommand</span><span class="p">,</span><span class="k">false</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">w</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>                    <span class="k">this</span><span class="p">.</span><span class="n">EventArrived</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                    <span class="n">w</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">EventArrived</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">SelectQuery</span> <span class="n">sq</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="s">&quot;Select * from Win32_Process Where ProcessId = &quot;</span> <span class="p">+</span> <span class="n">ProcessId</span><span class="p">);</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectSearcher</span> <span class="n">searcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementObjectSearcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">sq</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">foreach</span> <span class="p">(</span><span class="n">ManagementObject</span> <span class="n">queryObj</span> <span class="k">in</span> <span class="n">searcher</span><span class="p">.</span><span class="n">Get</span><span class="p">())</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">queryObj</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">(</span><span class="s">&quot;Terminate&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span><span class='line'>                        <span class="n">queryObj</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
</span><span class='line'>                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; timed out and was killed on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">else</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ExitCode</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot;exited with exit code &quot;</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">ExitCode</span> <span class="p">+</span> <span class="s">&quot; on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span> <span class="p">+</span> <span class="s">&quot; run as &quot;</span> <span class="p">+</span> <span class="n">strUserName</span><span class="p">);</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;process exited with Exit code 0&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;Execute process failed Machinename {0}, ProcessName {1}, RunAs {2}, Error is {3}, Stack trace {4}&quot;</span><span class="p">,</span> <span class="n">remoteComputerName</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">strUserName</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">StackTrace</span><span class="p">),</span> <span class="n">e</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-09-05T22:46:14+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 5 Sep, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/09/05/running-powershell-remotely/" itemprop="url">Running Powershell Remotely</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Code snippet for running power shell on a remote machine. Loosely based on blog post <a href="https://com2kid.wordpress.com/2011/09/22/remotely-executing-commands-in-powershell-using-c/">here</a> and <a href="https://www.codeproject.com/Articles/773685/Enable-Remote-PowerShell-Execution-in-Csharp">here</a></p>

<p>Add reference to System.Management.Automation</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System.Management.Automation</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Management.Automation.Runspaces</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">internal</span> <span class="k">void</span> <span class="nf">runPowershellRemotely</span><span class="p">(</span><span class="kt">string</span> <span class="n">location</span><span class="p">,</span> <span class="kt">string</span> <span class="n">scriptToBeRun</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">userName</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineLogonUser&quot;</span><span class="p">];</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">password</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineUserPassword&quot;</span><span class="p">];</span>
</span><span class='line'>           <span class="kt">var</span> <span class="n">securestring</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SecureString</span><span class="p">();</span>
</span><span class='line'>            <span class="k">foreach</span> <span class="p">(</span><span class="n">Char</span> <span class="n">c</span> <span class="k">in</span> <span class="n">password</span><span class="p">){</span>
</span><span class='line'>                <span class="n">securestring</span><span class="p">.</span><span class="n">AppendChar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">PSCredential</span> <span class="n">creds</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PSCredential</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span> <span class="n">securestring</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// Remove logging if not needed</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Running Powershell {0} at location {1}&quot;</span><span class="p">,</span> <span class="n">scriptToBeRun</span><span class="p">,</span> <span class="n">location</span><span class="p">));</span>
</span><span class='line'>            <span class="n">WSManConnectionInfo</span> <span class="n">connectionInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WSManConnectionInfo</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>           <span class="n">connectionInfo</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachine&quot;</span><span class="p">];</span>
</span><span class='line'>            <span class="n">connectionInfo</span><span class="p">.</span><span class="n">Credential</span> <span class="p">=</span> <span class="n">creds</span><span class="p">;</span>
</span><span class='line'>            <span class="n">Runspace</span> <span class="n">runspace</span> <span class="p">=</span> <span class="n">RunspaceFactory</span><span class="p">.</span><span class="n">CreateRunspace</span><span class="p">(</span><span class="n">connectionInfo</span><span class="p">);</span>
</span><span class='line'>            <span class="n">runspace</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">PowerShell</span> <span class="n">ps</span> <span class="p">=</span> <span class="n">PowerShell</span><span class="p">.</span><span class="n">Create</span><span class="p">())</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">Runspace</span> <span class="p">=</span> <span class="n">runspace</span><span class="p">;</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">AddScript</span><span class="p">(</span><span class="s">@&quot;cd &quot;</span><span class="p">+</span> <span class="n">location</span><span class="p">);</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">AddScript</span><span class="p">(</span><span class="n">scriptToBeRun</span><span class="p">);</span>
</span><span class='line'>                <span class="k">try</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="kt">var</span> <span class="n">results</span> <span class="p">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">Invoke</span><span class="p">();</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Results from Powershell Script is ---------------------------&quot;</span><span class="p">);</span>
</span><span class='line'>                    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">x</span> <span class="k">in</span> <span class="n">results</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : End of results--------------------------------- ---------------------------&quot;</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Error</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Exception from running Powershell Script is&quot;</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">runspace</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-09-03T22:59:54+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 Sep, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/09/03/working-with-windows-services/" itemprop="url">Working With Windows Services</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Below is code snippet for working with windows service. It helps to find status of service, start , stop and restart as required.</p>

<p>We need to pass in details of windows services name ( as shown i services.msc ) and machine name(should be in same network).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System.ServiceProcess</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>          <span class="k">internal</span> <span class="kt">string</span> <span class="nf">FindStatus</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\tStatus of {0} service in {1} is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">internal</span> <span class="kt">string</span> <span class="nf">StopService</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">myService</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Running</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">WaitForStatus</span><span class="p">(</span><span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Stopped</span><span class="p">);</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\t{0} service Stopped in {1}. Current Status is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">internal</span> <span class="kt">string</span> <span class="nf">StartService</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">myService</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Stopped</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">WaitForStatus</span><span class="p">(</span><span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Running</span><span class="p">);</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\t{0} service Started in {1}. Current Status is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-09-01T22:05:42+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 1 Sep, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/09/01/comparing-xml-file-structure-without-xsd/" itemprop="url">Comparing XML File Structure Without XSD</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Code snippet for comparing two xml files without using xsd for validating their structure is same ( nodes and arguments should be same. Values of each node/argument can be different).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">internal</span> <span class="k">void</span> <span class="nf">VerifyMessageHaveSimilarStructureOfTemplate</span><span class="p">(</span><span class="kt">string</span> <span class="n">inputXml</span><span class="p">,</span> <span class="kt">string</span> <span class="n">templateXml</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">docA</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">docB</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">docA</span><span class="p">.</span><span class="n">LoadXml</span><span class="p">(</span><span class="n">inputXml</span><span class="p">);</span>
</span><span class='line'>            <span class="n">docB</span><span class="p">.</span><span class="n">LoadXml</span><span class="p">(</span><span class="n">templateXml</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">var</span> <span class="n">isDifferent</span> <span class="p">=</span> <span class="n">DoTheyHaveDiferentStructure</span><span class="p">(</span><span class="n">docA</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">,</span> <span class="n">docB</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">);</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;Result of Checking for difference of Input xml with template is : &quot;</span> <span class="p">+</span> <span class="n">isDifferent</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">private</span> <span class="kt">bool</span> <span class="nf">DoTheyHaveDiferentStructure</span><span class="p">(</span><span class="n">XmlNodeList</span> <span class="n">xmlNodeListA</span><span class="p">,</span> <span class="n">XmlNodeList</span> <span class="n">xmlNodeListB</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">xmlNodeListA</span><span class="p">.</span><span class="n">Count</span> <span class="p">!=</span> <span class="n">xmlNodeListB</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">xmlNodeListA</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="kt">var</span> <span class="n">nodeA</span> <span class="p">=</span> <span class="n">xmlNodeListA</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>                <span class="kt">var</span> <span class="n">nodeB</span> <span class="p">=</span> <span class="n">xmlNodeListB</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">else</span>
</span><span class='line'>                        <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span> <span class="p">!=</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span> <span class="p">||</span> <span class="n">nodeA</span><span class="p">.</span><span class="n">Name</span> <span class="p">!=</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">AttributeNameA</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
</span><span class='line'>                <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">AttributeNameB</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
</span><span class='line'>                <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Name</span><span class="p">);</span>
</span><span class='line'>                    <span class="n">AttributeNameB</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Name</span><span class="p">);</span>
</span><span class='line'>                    <span class="c1">// -- If attribute position should be same, then include below as well</span>
</span><span class='line'>                    <span class="c1">//var attrA = nodeA.Attributes[j];</span>
</span><span class='line'>                    <span class="c1">//var attrB = nodeB.Attributes[j];</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">//if (attrA.Name != attrB.Name) return true;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">Sort</span><span class="p">();</span>
</span><span class='line'>                <span class="n">AttributeNameB</span><span class="p">.</span><span class="n">Sort</span><span class="p">();</span>
</span><span class='line'>                <span class="k">if</span><span class="p">(!</span> <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">SequenceEqual</span><span class="p">(</span><span class="n">AttributeNameB</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">HasChildNodes</span> <span class="p">&amp;&amp;</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">HasChildNodes</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">return</span> <span class="nf">HaveDiferentStructure</span><span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">,</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-05-27T08:03:28+10:00"  data-updated="true" itemprop="datePublished dateCreated">27 May, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/05/27/running-api-test-using-cypress/" itemprop="url">Running API Test Using Cypress</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>Cypress is not just UI automation tool . It can be used for testing APIs as well . Even though we have other tools like Postman, Newman, Rest Assured, SOAP UI etc for testing APIs, I believe cypress is a good alternative for testing API. It will help to use same tool for both UI and API test automation.</p>

<h2>Demo</h2>

<p>Let us look at a sample API test case. In below example, we trigger a API call to <code>http://services.groupkt.com/country/get/iso2code/AU</code> and validate below in the response.</p>

<ul>
<li>Status code of response is 200.</li>
<li>Header include &lsquo;application/json&rsquo;.</li>
<li>Body contain &ldquo;Country found matching code [AU].&rdquo;</li>
</ul>


<p>We can then extend this to do any further checks if needed.</p>

<p>Create a new file inside <code>Integration</code> folder of cypress and copy below code into that.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>describe('API Testing with Cypress', () =&gt; {
</span><span class='line'>    var result
</span><span class='line'>    
</span><span class='line'>    it('Validate the header', () =&gt; {
</span><span class='line'>       result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>      
</span><span class='line'>       result.its('headers')
</span><span class='line'>             .its('content-type')
</span><span class='line'>             .should('include', 'application/json')
</span><span class='line'>        
</span><span class='line'>    })
</span><span class='line'>
</span><span class='line'>    it('Validate the status', () =&gt; {
</span><span class='line'>        result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>       
</span><span class='line'>        result.its('status')
</span><span class='line'>              .should('equal',200);
</span><span class='line'>     })
</span><span class='line'>
</span><span class='line'>     it('Validate the body ', () =&gt; {
</span><span class='line'>        result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>       
</span><span class='line'>        result.its('body')
</span><span class='line'>              .its('RestResponse.messages')
</span><span class='line'>              .should('include', 'Country found matching code [AU].');
</span><span class='line'>      
</span><span class='line'>     })
</span><span class='line'>}) 
</span></code></pre></td></tr></table></div></figure>


<p>Open Cypress by running <code>node_modules/.bin/cypress open</code> inside cypress root folder. This will open up Cypress.</p>

<p>Run newly created test.</p>

<p><img src="/images/2018/05/27/01%20Run%20Test%20Case.png" alt="APITestingWithCypress" /></p>

<p>Results of test execution will look like below.</p>

<p><img src="/images/2018/05/27/02%20Check%20Result.png" alt="[APITestingWithCypress]" /></p>

<p>Expand each of them and right click on the asserts and inspect the element. This will open up chrome developer tool. Select the console tab , which will list down details of calls made, request received and assertions performed.  It will help to write additional assertions, investigate any failure etc.</p>

<p><img src="/images/2018/05/27/03%20Expand%20and%20Analyse%20result.png" alt="[APITestingWithCypress]" /></p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-05-11T07:31:39+10:00"  data-updated="true" itemprop="datePublished dateCreated">11 May, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/05/11/ui-automation-with-cypress/" itemprop="url">UI Automation With Cypress</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>When we talk about UI automation for browsers, the default tool which comes to mind is Selenium. There are different wrappers around selenium like protractor, Nightwatch , selenium webdriver etc. All of them are build on top of selenium and have all advantages /disadvantages of selenium. All of the control browser by executing remote commands through Network. We will most probably need additional libraries, framework etc to make full use of selenium.</p>

<p>Cypress.io is an open source UI automation tool which can be used for UI testing . Unlike others, this is not build on top of selenium . Instead is a complete new architecture and run in same run loop as browser. So it is running inside browser and have access to almost everything happening inside and outside browser. It is a complete set of tools that you will require to create and run E2E UI automation test cases. Team who developed cypress has made few design trade off which causes some disadvantages to cypress. There is no right tool for automation . It will depend on multiple factors.</p>

<h2>Installing Cypress</h2>

<p>We can install cypress using npm. Run below command inside project folder to install cypress and all dependencies.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install cypress --save-dev</span></code></pre></td></tr></table></div></figure>


<p>Another way of using cypress is to download zip file from <a href="https://www.cypress.io/features/">here</a> . Just extract the file and start using it.</p>

<h2>Opening Cypress</h2>

<p>Cypress can be opened by running <code>node_modules/.bin/cypress open</code> command in terminal under /cypress.</p>

<p>If you have downloaded the zip file, you can open cypress by double clicking on the cypress executable.</p>

<h2>Write your first test</h2>

<p>Cypress already come with predefined example of KitchenSink application which will help you to identify various commands which can be used. It can be found under <code>cypress\integration\example_spec.js</code>.</p>

<p>Let us look at how to write a new test .</p>

<p>Create a new test script file called <code>demotest.js</code> under <code>{project_location}\cypress\integration</code>. Open up the file and write below code into it.</p>

<p>This code will open browser, load google and search for cypress.io and open up the first link.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>describe('My first test for cypress', function() {
</span><span class='line'>    it('Visits google home page ', function() {
</span><span class='line'>      cy.visit('https://google.com');
</span><span class='line'>    })
</span><span class='line'>    it('should load the Google Homepage', () =&gt; {
</span><span class='line'>        cy.title().should('eql', 'Google');
</span><span class='line'>    })
</span><span class='line'>    it('should search and open cypress home page', () =&gt; {
</span><span class='line'>        cy.get('#lst-ib').type('cypress.io');
</span><span class='line'>        cy.get('[value="I\'m Feeling Lucky"]').focus().click();
</span><span class='line'>    })
</span><span class='line'>   
</span><span class='line'>   
</span><span class='line'>  })</span></code></pre></td></tr></table></div></figure>


<p>Note: If cross origin policy error is shown, flow the workarounds mentioned.</p>

<h2>How does cypress.io compare with Selenium</h2>

<p>As mentioned earlier, there is no right or wrong tool for automation. It all depends on suitability for the task on hand. Let us compare few features where cypress.io and selenium have differences.</p>

<ul>
<li>Cross browser support - At this point selenium have more cross browser support that cypress. Cypress supports only chrome variants. You can read about them <a href="https://github.com/cypress-io/cypress/issues/310">here</a></li>
<li>Debugging capability - This is high in cypress. I found that error message are more details and infact provide some more details about how to fix it. Also you have full access to chrome dev tools.</li>
<li>Keypress - As of now , cypress doesnt support pressing Tab key . You can read about it <a href="https://github.com/cypress-io/cypress/issues/299">here</a>.</li>
<li>Since cypress is build on node.js, we can chain commands together</li>
<li>Cypress.io have built in support for test framework and assertion libraries like mocha, chai etc</li>
<li>Cypress.io test cases can be written in Javascript</li>
<li>Cypress.io handles wait times better than selenium</li>
<li>Cypress.io have hot reloading of test cases. When we make changes to test cases and save it , the test rerun by itself. This is very effective to reduce time spend on building and rerunning selenium based test cases.</li>
<li>Cypress.io have built in time travel and screenshots which will help us to go back to failure points and debug. It also capture before and after state for all actions</li>
</ul>


<p>I will keep adding to this when I play more with cypress.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-05-03T21:05:00+10:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 May, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/05/03/writing-tests-in-postman/" itemprop="url">Writing Tests in Postman</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>In previous blog <a href="/blog/2018/04/28/postman-bdd/">post</a>, we saw how to use BDD format for writing test cases in postman. Most important part of writing tests in postman is understanding various features available. Let us explore various options available . The examples specified in postman <a href="https://documenter.getpostman.com/view/220187/postman-bdd-examples/6Z3uY71#30dfc9d2-5de4-b932-db3e-641c29fb0459">documentation</a>, have lot of information about how to setup postman bdd, use chai http assertions, create custom assertions and use before and after hooks. Please import them into postman and try that by yourself to familiarise with postman BDD. Below is only few examples from them.</p>

<p>Postman BDD makes use of Chai Assertion Library and Chai-Http. We have access to both libray and postman scripting environment for writing test cases. Chai has two types of assertion styles.</p>

<ul>
<li><code>Expect/should</code> for BDD</li>
<li><code>Assert</code> for TDD</li>
</ul>


<p>Both styles support chainable language to construct assertions. We can use both of them to write postman test assertions. If you need details of all chainable constructs, please refer to their <a href="http://www.chaijs.com/api/bdd/">documentation</a>. Major ones which we may use in postman tests are</p>

<ul>
<li><p>Chains</p>

<pre><code>  to
  be
  been
  is
  that
  which
  and
  has
  have
  with
  at
  of
  same
  but
  does
</code></pre></li>
<li><p>Not - Negates all conditions</p></li>
<li>any -</li>
<li>all -</li>
<li>inlcude</li>
<li>OK</li>
<li>true</li>
<li>false</li>
<li>null</li>
<li>undefined</li>
<li>exist</li>
<li>empty</li>
<li>match(re[, msg])</li>
</ul>


<p>Chai-Http module provide various assertions. Read through their documentation <a href="https://github.com/chaijs/chai-http#assertions">here</a> to know details. Below are main commands at our disposal for validation .</p>

<ul>
<li>.status(code)</li>
<li>.header (key[, value])</li>
<li>.headers</li>
<li>.ip</li>
<li>.json / .text / .html</li>
<li>.redirect</li>
<li>.param</li>
<li>.cookie</li>
</ul>


<p>Postman bdd provide <code>response</code> object on which we do most of assertions. It will have all information like response.text, response.body, response.status, response.ok , response.error. Postman BDD will automatically parse JSON and XML responses and hence there is no need to call JSON.parse() or xml2json(). response.text will have unparsed content. It also have automatic error handling , which will allow to continue with other test even if something fails.</p>

<p>Examples for various assertions done on response object are below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\\Verifying Header information
</span><span class='line'>expect(response).to.have.status(500);
</span><span class='line'>expect(response).to.have.header('x-api-key');
</span><span class='line'>expect(response).to.have.header('content-type', 'text/plain');
</span><span class='line'>expect(request).to.have.header('content-type', /^text/);
</span><span class='line'>expect(response).to.have.headers;
</span><span class='line'>expect('127.0.0.1').to.be.an.ip;
</span><span class='line'>
</span><span class='line'>\\Verifying Response body
</span><span class='line'>expect(response).to.be.json;
</span><span class='line'>expect(response).to.be.html;
</span><span class='line'>expect(response).to.be.text;
</span><span class='line'>
</span><span class='line'>response.should.have.status(200); 
</span><span class='line'>response.body.should.not.be.empty;
</span><span class='line'>response.ok.should.be.true;            // sucess with code 2XX
</span><span class='line'>response.error.should.be.true; //failures
</span><span class='line'>
</span><span class='line'>\\Verifying request
</span><span class='line'>expect(req).to.have.param('orderby', 'date');
</span><span class='line'>expect(req).to.not.have.param('orderby');
</span><span class='line'>expect(req).to.have.cookie('session_id', '1234');
</span><span class='line'>expect(req).to.not.have.cookie('PHPSESSID');
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>If we use above assertions in proper BDD format, it will look like below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>eval(globals.postmanBDD);
</span><span class='line'>describe('Example for Blog using SHOULD', function(){
</span><span class='line'>   it("Tests using SHOULD", function() {
</span><span class='line'>      response.should.have.status(200); 
</span><span class='line'>      response.should.not.be.empty;
</span><span class='line'>      response.should.have.header('content-type', 'application/json; charset=utf-8');
</span><span class='line'>      response.type.should.equal('application/json');
</span><span class='line'>      
</span><span class='line'>      var user = response.body.results[0];
</span><span class='line'>      user.name.should.be.an('object');
</span><span class='line'>      user.name.should.have.property('first').and.not.empty;
</span><span class='line'>      //user.name.should.have.property('first','david');
</span><span class='line'>      user.should.have.property('gender','male');
</span><span class='line'>   
</span><span class='line'>   
</span><span class='line'>   }) 
</span><span class='line'>})
</span><span class='line'>describe('Example for Blog using Expect', function(){
</span><span class='line'>   it("Tests using EXPECT", function() {
</span><span class='line'>      expect(response).to.have.status(200);
</span><span class='line'>      expect(response).not.empty;
</span><span class='line'>      expect(response).to.be.json;
</span><span class='line'>      expect(response).to.have.header('content-type', 'application/json; charset=utf-8');
</span><span class='line'>   }) 
</span><span class='line'>})
</span><span class='line'>
</span><span class='line'>it('should contain the un-parsed JSON text', () =&gt; {
</span><span class='line'>    response.text.should.be.a('string').with.length.above(50);
</span><span class='line'>    response.text.should.contain('"results":[');
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/2018/05/03/postman%20bdd.png" alt="Postman" /></p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-04-28T07:46:43+10:00"  data-updated="true" itemprop="datePublished dateCreated">28 Apr, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/04/28/postman-bdd/" itemprop="url">Postman BDD</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>In Previous blog post,we discussed about <a href="/blog/2017/08/05/postman-tutorial/">how to use postman</a> and how to use <a href="/blog/2017/08/07/running-postman-collection-using-newman/">collections using newman </a>and <a href="/blog/2017/08/13/postman-using-data-file">data file</a>. If you haven&rsquo;t read that , please have a read through first .</p>

<p>In previous examples, we discussed about writing tests/assertions in postman. We followed normal Javascript syntax for writing test cases including asserting various factors of response ( like content , status code etc). Eventhough this is a straightforward way of writing, many people would like to use existing javascript test library like Mocha. They can use <a href="https://github.com/BigstickCarpet/postman-bdd/#installation">postman - bdd</a> libraries.</p>

<p>Let us take a deep dive into how to use setup postman bdd.</p>

<p>Note: It is assumed that user already have postman and newman installed on their machine along with their dependencies.</p>

<h2>Installing Postman BDD</h2>

<p>Installation is done triggering a Get request and setting the response as Global environment variable.</p>

<ul>
<li>Create a GET request to <code>http://bigstickcarpet.com/postman-bdd/dist/postman-bdd.js</code></li>
<li>Set Global environment variable by using below command in test tab. <code>postman.setGlobalVariable('postmanBDD', responseBody);</code></li>
</ul>


<p><img src="/images/2018/04/28/Installing%20Postman%20BDD.png" alt="PostManRequest" /></p>

<p>Once we trigger above get request, postman bdd will be available for use.  We can make use of postman BDD features by below command
<code>eval(globals.postmanBDD);</code></p>

<h2>Writing Tests</h2>

<p>Postman bdd library provide us with flexibility to write tests and assertions using fluent asserts and have best features of Chai and Mocha. Inorder to demonstrate this, I am using sample Tutorial given with postman client.</p>

<p>Open up the sample Request in Postman Tutorial folder under collections. It will already have some test predefined in Test tab. Remove them and add below test to it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>eval(globals.postmanBDD)
</span><span class='line'>//eval(postman.getGlobalVariable('postmanBDD'));
</span><span class='line'>var jsonData = JSON.parse(responseBody);
</span><span class='line'>describe('Testing Sample Request in Postman Tutorial', function () {
</span><span class='line'>  it('CASE 1: Should respond with statusCode = 200', function () {
</span><span class='line'>      response.should.have.status(200);
</span><span class='line'>  });
</span><span class='line'>  it('CASE 2: Should response time less than 500 ms', function () {
</span><span class='line'>      pm.response.responseTime.should.be.below(500);
</span><span class='line'>  });
</span><span class='line'>  it('CASE 3: User ID should be 1', function () {
</span><span class='line'>      jsonData.userId === 1;
</span><span class='line'>  });
</span><span class='line'>
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>Note: You can find more details of various type of asserts in <a href="http://www.chaijs.com/api/bdd/">http://www.chaijs.com/api/bdd/</a></p>

<p>Once it is done, trigger the request</p>

<p><img src="/images/2018/04/28/Postman%20BDD%20example.png" alt="PostManRequest" />.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-03-20T11:46:30+11:00"  data-updated="true" itemprop="datePublished dateCreated">20 Mar, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/03/20/gulp-task-for-running-automated-test/" itemprop="url">Gulp Task for Running Automated Test</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p><a href="https://gulpjs.com/">Gulp</a> is a toolkit for automating painful or time-consuming task in your development workflow, so you can stop messing around and build something. Gulp can be used for creating a simple task to run automated test cases.</p>

<p>Firstly, we will create package.json file for this project. This can be done by below command from project folder. It will prompt you to enter a list of information required for creating package.json file</p>

<pre><code>npm init
</code></pre>

<p>Once this is done, install gulp.  It can be done by below command. This will add gulp as a dev dependency.</p>

<pre><code>npm install --save-dev gulp-install
</code></pre>

<p>In order to run acceptance test cases, we will need to install nunit/xunit test runners. It can be done by below command from the root folder.</p>

<pre><code>npm install --save-dev gulp-nunit-runner
        OR
npm install --save-dev gulp-xunit-runner
</code></pre>

<p>Detailed usage of above test runners are available <a href="https://www.npmjs.com/package/gulp-nunit-runner">here</a>.</p>

<p>Once above are installed, we need to create <code>gulpfile.js</code> inside root folder. This file will have details of various gulp tasks</p>

<p>Sample Usage of test runner is below. Insert this code into gulpfile.js</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var gulp = require('gulp'),
</span><span class='line'>    nunit = require('gulp-nunit-runner');
</span><span class='line'> 
</span><span class='line'>gulp.task('unit-test', function () {
</span><span class='line'>    return gulp.src(['**/*.Test.dll'], {read: false})
</span><span class='line'>        .pipe(nunit({
</span><span class='line'>            executable: 'C:/nunit/bin/nunit-console.exe',
</span><span class='line'>            options : {
</span><span class='line'>              where : 'cat == test'
</span><span class='line'>            }
</span><span class='line'>        }));
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>{read: false} means, it will read only file names and not the entire file.</li>
<li>Executable is the path to nunit console runner, which should be available.</li>
<li>gulp.src is that path to acceptance test solution dll. Since we use wild character, we may have to modify this path to reflect the exact path of dll.( something like ./**/Debug/Project.acceptancetest.dll)</li>
</ul>


<p>Once we have above in gulpfile.js, it can be run by below command</p>

<pre><code>gulp unit-test
</code></pre>

<p>Out of above command will be something like</p>

<pre><code>C:/nunit/bin/nunit-console.exe "C:\full\path\to\Database.Test.dll" "C:\full\path\to\Services.Test.dll"
</code></pre>

<p>Note: If it complains about assembly missing, it means path to acceptance test solution is incorrect . Retry after fixing the path.</p>

<p>Gulp Nunit runner provide lot options to configure test run, like selecting test cases based on category, creating output files etc. Detailed options can be found <a href="https://github.com/keithmorris/gulp-nunit-runner">here</a>.</p>

<p>Below is an example with few options</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var gulp = require('gulp'),
</span><span class='line'>    nunit = require('gulp-nunit-runner');
</span><span class='line'> 
</span><span class='line'>gulp.task('unit-test', function () {
</span><span class='line'>    return gulp.src(['**/*.Test.dll'], {read: false})
</span><span class='line'>        .pipe(nunit({
</span><span class='line'>            executable: 'C:/nunit/bin/nunit-console.exe',
</span><span class='line'>            options : {
</span><span class='line'>              where : 'cat == test',
</span><span class='line'>              work : 'TestResultsFolder',
</span><span class='line'>              result : 'TestResults.xml',
</span><span class='line'>              config : 'Debug'
</span><span class='line'>            }
</span><span class='line'>        }));
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Where - Selects the category which needs to be run</li>
<li>Work - Create a folder with specified path/name for output files</li>
<li>result - create test results in xml</li>
<li>config - select the config which needs to be run</li>
</ul>


<p>If we run <code>gulp unit-test</code> now, it will execute only the test cases having category <code>test</code>. It will create a folder named <code>TestResultsFolder</code> and will have an xml report of the test run inside it .  The folder will be created in root where we have gulpfile.js.</p>
</div>
  
  


        </article>
      
      
        <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-03-01T22:18:25+11:00"  data-updated="true" itemprop="datePublished dateCreated"> 1 Mar, 2018</time>
        
      </p>
    
    
      <h2 class="entry-title" itemprop="name headline"><a href="/blog/2018/03/01/extracting-metrics-from-teamcity/" itemprop="url">Extracting Metrics From TeamCity</a></h2>
    
  </header>


  <div class="entry-content clearfix" itemprop="articleBody description"><p>TeamCity is a java based build management and continuous Integration server from JetBrains. Very often , we will have to extract various metrics from TeamCity for tracking and trend analysis.  TeamCity provides versatile api for extracting various metrics which can then be manipulated or interpreted as we need.</p>

<p>Below are basic api calls which can be used for extracting mertics. Please note that TeamCity api is powerful enough to do much more than extraction of data. However, for this blog post, I am focussing on metrics extraction part alone. All of these are GET request to TeamCity api with a valid user credentials ( use any id/password which can access TeamCity)</p>

<ol>
<li>Get List of Projects - <a href="http://teamcityURL:9999/app/rest/projects">http://teamcityURL:9999/app/rest/projects</a></li>
<li>Get details of a project - <a href="http://teamcityURL:9999/app/rest/projects/">http://teamcityURL:9999/app/rest/projects/</a>(projectlocator)
Project locator  can be either &ldquo;id:projectID&rdquo; or &ldquo;name:projectName&rdquo;</li>
<li>Get List of Build configuration - <a href="http://teamcityURL:9999/app/rest/buildTypes">http://teamcityURL:9999/app/rest/buildTypes</a></li>
<li>Get List of Build configuration for a project- <a href="http://teamcityURL:9999/app/rest/projects/">http://teamcityURL:9999/app/rest/projects/</a>(projectLocator)buildTypes</li>
<li>Get List of Build  - <a href="http://teamcityURL:9999/app/rest/builds/?locator=">http://teamcityURL:9999/app/rest/builds/?locator=</a>(buildLocator)</li>
<li>Get details of a specific Build  - <a href="http://teamcityURL:9999/app/rest/builds/">http://teamcityURL:9999/app/rest/builds/</a>(buildLocator)
Build locator can be &ldquo;id:BuildId&rdquo; or &ldquo;number:buildNumber&rdquo; Or a combination of these like &ldquo;id:BuildId,number:buildNumber,dimension3:dimensionvalue&rdquo;. We can use various different values for these dimension. Details can be found in TeamCity documentation</li>
<li>Get List of tests in a build - <a href="http://teamcityURL:9999/app/rest/testOccurrences?locator=build:">http://teamcityURL:9999/app/rest/testOccurrences?locator=build:</a>(buildLocator)</li>
<li>Get individual test history - <a href="http://teamcityURL:9999/app/rest/testOccurrences?locator=test:">http://teamcityURL:9999/app/rest/testOccurrences?locator=test:</a>(testLocator)</li>
</ol>


<p>Recently I created a Nodejs program to extract below metrics by chaining some of the above api calls.</p>

<ul>
<li>Number of builds between any two given dates and their status</li>
<li>Details of number of test cases and their status , pass percentage, fail percentage etc for each build</li>
<li>Details as above for entire period.</li>
<li>Trend of test progress, build failures etc between those dates</li>
<li>Create an output JSON with cumulative counts of passed/failed/ignored builds, passed/failed/ignored test cases , percentage of sucessful builds, frequency of pull request and their success rates etc.</li>
</ul>

</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous"><a href="/posts/2">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next disabled"><a href="#">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/codesnippets/index.html">
        <span class="badge">10</span>
        codesnippets
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/java/index.html">
        <span class="badge">2</span>
        java
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/excel/index.html">
        <span class="badge">3</span>
        excel
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium/index.html">
        <span class="badge">4</span>
        selenium
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/volunteering/index.html">
        <span class="badge">1</span>
        volunteering
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/nodejs/index.html">
        <span class="badge">1</span>
        nodejs
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/data-driven-testing-framework/index.html">
        <span class="badge">3</span>
        data driven testing framework
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium-webdriver/index.html">
        <span class="badge">3</span>
        selenium webdriver
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/xml/index.html">
        <span class="badge">2</span>
        xml
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/specflow/index.html">
        <span class="badge">6</span>
        specflow
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/bdd/index.html">
        <span class="badge">1</span>
        bdd
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/element-identification/index.html">
        <span class="badge">4</span>
        element identification
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/nunit/index.html">
        <span class="badge">3</span>
        nunit
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/c#/index.html">
        <span class="badge">1</span>
        c#
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/command-line/index.html">
        <span class="badge">2</span>
        command line
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/git/index.html">
        <span class="badge">2</span>
        git
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/powershell/index.html">
        <span class="badge">3</span>
        powershell
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/mountebank/index.html">
        <span class="badge">8</span>
        mountebank
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualisation/index.html">
        <span class="badge">5</span>
        service virtualisation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octopress/index.html">
        <span class="badge">1</span>
        octopress
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octostrap3/index.html">
        <span class="badge">1</span>
        octostrap3
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/galen/index.html">
        <span class="badge">2</span>
        galen
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/javascript/index.html">
        <span class="badge">1</span>
        javascript
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/postman/index.html">
        <span class="badge">6</span>
        postman
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/newman/index.html">
        <span class="badge">4</span>
        newman
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/conference/index.html">
        <span class="badge">1</span>
        conference
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/test/index.html">
        <span class="badge">1</span>
        test
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/automation/index.html">
        <span class="badge">1</span>
        automation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/agile/index.html">
        <span class="badge">1</span>
        agile
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualization/index.html">
        <span class="badge">1</span>
        service virtualization
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/accessibility/index.html">
        <span class="badge">1</span>
        accessibility
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/testing/index.html">
        <span class="badge">1</span>
        testing
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/team-city/index.html">
        <span class="badge">1</span>
        team city
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/metrics/index.html">
        <span class="badge">1</span>
        metrics
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/gulp/index.html">
        <span class="badge">1</span>
        gulp
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/cypress/index.html">
        <span class="badge">2</span>
        cypress
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/api-testing/index.html">
        <span class="badge">1</span>
        api testing
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/windows-services/index.html">
        <span class="badge">1</span>
        windows services
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/wmi/index.html">
        <span class="badge">1</span>
        wmi
      </a>
    
  </div>
</section><section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2018/09/08/running-command-line-in-remote-machine-using-wmi/">Running Command Line in Remote Machine Using WMI</a>
    
    <a class="list-group-item " href="/blog/2018/09/05/running-powershell-remotely/">Running Powershell Remotely</a>
    
    <a class="list-group-item " href="/blog/2018/09/03/working-with-windows-services/">Working With Windows Services</a>
    
    <a class="list-group-item " href="/blog/2018/09/01/comparing-xml-file-structure-without-xsd/">Comparing XML File Structure Without XSD</a>
    
    <a class="list-group-item " href="/blog/2018/05/27/running-api-test-using-cypress/">Running API Test Using Cypress</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'abygeorgea',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2018 - Aby George A<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'abygeorgea';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


	
  </body>
</html>
