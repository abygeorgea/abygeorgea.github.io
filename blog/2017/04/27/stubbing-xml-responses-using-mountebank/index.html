<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Stubbing XML Responses Using Mountebank - Aby George A</title>
  <meta name="author" content="Aby George A">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.abygeorgea.com/blog/2017/04/27/stubbing-xml-responses-using-mountebank/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Aby George A" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.abygeorgea.com/blog/2017/04/27/stubbing-xml-responses-using-mountebank/">
  <meta property="og:title" content="Stubbing XML Responses Using Mountebank - Aby George A">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-99127431-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Aby George A</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
				<li >
                    <a href="/about">About Me</a>
                </li>
				<li >
                    <a href="/quick-reference">Quick Reference</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.abygeorgea.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Aby George A" />
    
    <meta itemprop="url" content="http://www.abygeorgea.com" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-04-27T05:55:51+10:00"  data-updated="true" itemprop="datePublished dateCreated">27 Apr, 2017</time>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Stubbing XML Responses Using Mountebank
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>Previous two blog post talked about how we can use mountebank for stubbing where responses are in json format . They can be accessed (<a href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/">here</a>) and (<a href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">here</a>). We can use same approach for stubbing SOAP services using XML as well. In this post, I will explain how we can provide XML response using Mountebank .</p>

<p>Let us have a quick look into the files created. Before we begin, folder structure of various file as below</p>

<p><img src="/images/2017/04/27/Mountebank_XML_Response_Folder-Tree.jpg" alt="folderstructure" /></p>

<h4>Imposter.ejs</h4>

<p>The main Imposter file is</p>

<figure class='code'><figcaption><span>Imposter.ejs</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>"imposters": [
</span><span class='line'>&lt;% include Port4547.json %&gt;
</span><span class='line'>]
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>Port4547.json</h4>

<p>This file specifies which port number to use and what all stubs needs to be created is as below</p>

<figure class='code'><figcaption><span>Port4547.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>"port": 4547,
</span><span class='line'>"protocol": "http",
</span><span class='line'>"stubs": [
</span><span class='line'>{
</span><span class='line'>&lt;% include XMLStubGET.json %&gt;
</span><span class='line'>},
</span><span class='line'>{
</span><span class='line'>&lt;% include XMLStubPOST.json %&gt;
</span><span class='line'>}
</span><span class='line'>]
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>XMLStubGET.json</h4>

<p>This is the first stub for this example and it looks for any request coming with the method &ldquo;GET&rdquo; and path &ldquo;/Blog.Api/[0-9]+/CustomerView&rdquo; , where [0-9]+ is regular expression of any numeric</p>

<figure class='code'><figcaption><span>XMLStubGET.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"responses": [
</span><span class='line'>{
</span><span class='line'>"inject": "&lt;%-stringify(filename, 'ResponseInjection\\GetXMLStub.js') %&gt;"
</span><span class='line'>}
</span><span class='line'>],
</span><span class='line'>"predicates": [
</span><span class='line'>{
</span><span class='line'>"matches": {
</span><span class='line'>"method" : "GET",
</span><span class='line'>"path" : "/Blog.Api/[0-9]+/CustomerView"
</span><span class='line'>}
</span><span class='line'>}
</span><span class='line'>]</span></code></pre></td></tr></table></div></figure>


<h4>XMLStubPOST.json</h4>

<p>This is the second stub for this example and it looks for any request coming with method &ldquo;POST&rdquo; and path &ldquo;/Blog.Api/XMLexamplePOST/[0-9]+&rdquo; , where [0-9]+ is regular expression of any numeric .It also needs a body as <Action>Insert</Action><Record>Customer1</Record></p>

<p>Note: If you have body in multi-line, then make sure to enter &ldquo;\n&rdquo; for new line</p>

<figure class='code'><figcaption><span>XMLStubPOST.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"responses": [
</span><span class='line'>{
</span><span class='line'>"inject": "&lt;%-stringify(filename, 'ResponseInjection\\GetXMLStub-POST.js') %&gt;"
</span><span class='line'>}
</span><span class='line'>],
</span><span class='line'>"predicates": [
</span><span class='line'>{
</span><span class='line'>"matches": {
</span><span class='line'>"body" : "&lt;Action&gt;Insert&lt;/Action&gt;&lt;Record&gt;Customer1&lt;/Record&gt;",
</span><span class='line'>"method" : "POST",
</span><span class='line'>"path" : "/Blog.Api/XMLexamplePOST/[0-9]+"
</span><span class='line'>}
</span><span class='line'>}
</span><span class='line'>]</span></code></pre></td></tr></table></div></figure>


<h4>GetXMLStub.js</h4>

<p>Below js file create a response based on template mentioned and return the response with proper status. Please note that, we are not using &ldquo;Json.Parse&rdquo; here as we did for previous examples involving json.</p>

<figure class='code'><figcaption><span>GetXMLStub.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function GetTemplateResponse (request, state, logger) {
</span><span class='line'>response = "&lt;%- stringify(filename, 'StubTemplate\\CustomerDetails.xml') %&gt;"
</span><span class='line'>return {
</span><span class='line'>statusCode : 200,
</span><span class='line'>headers: {
</span><span class='line'>'Content-Type': 'application/xml; charset=utf-8'
</span><span class='line'>},
</span><span class='line'>body: response
</span><span class='line'>};
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>GetXMLStub-POST.js</h4>

<figure class='code'><figcaption><span>GetXMLStub-POST.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function GetTemplateResponse (request, state, logger) {
</span><span class='line'>response = "&lt;%- stringify(filename, 'StubTemplate\\RecordAdded.xml') %&gt;"
</span><span class='line'>return {
</span><span class='line'>statusCode : 200,
</span><span class='line'>headers: {
</span><span class='line'>'Content-Type': 'application/xml; charset=utf-8'
</span><span class='line'>},
</span><span class='line'>body: response
</span><span class='line'>};
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>CustomerDetails.XML</h4>

<p>This is the template for the first stub - GET example</p>

<figure class='code'><figcaption><span>XML</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;customer&gt;
</span><span class='line'>  &lt;FirstName&gt;John&lt;/FirstName&gt;
</span><span class='line'>  &lt;LastName&gt;Citizen&lt;/LastName&gt;
</span><span class='line'>  &lt;Address&gt;Some St, Some State, Some Country&lt;/Address&gt;
</span><span class='line'>  &lt;Email&gt;Test@test.com&lt;/Email&gt;
</span><span class='line'>&lt;/customer&gt;</span></code></pre></td></tr></table></div></figure>


<h4>RecordAdded.xml</h4>

<p>This is the template for the second stub - POST example</p>

<figure class='code'><figcaption><span>XML</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;Status&gt;Added&lt;/Status&gt;
</span><span class='line'>&lt;Record&gt;Customer1&lt;/Record&gt;</span></code></pre></td></tr></table></div></figure>


<p>After creating above files and keeping them as per directory structure is shown above, it is time to start mountebank</p>

<blockquote><p>mb &ndash;configfile SOAP-XMLStubExample/Imposter.ejs &ndash;allowInjection</p></blockquote>

<p>Note: Give the right path to Imposter.ejs . If you need to debug Mountebank, you can use below command at the end &ldquo; &ndash;loglevel debug&rdquo;</p>

<p>Now trigger a get request to <a href="http://localhost:4547/Blog.Api/3123/CustomerView.">http://localhost:4547/Blog.Api/3123/CustomerView.</a></p>

<p>This should match with our first predicate and should return the response mentioned</p>

<p>Mountebank_XML_Response_</p>

<p>Now trigger a POST request with a body . If predicates are matched, then it will respond with expected response as below</p>

<p><img src="/images/2017/04/27/Mountebank_XML_Response_PostmanRequest1.png" alt="PostManRequest" /></p>

<p>In Nut shell, creating a XML response is similar to creating json response. There are only minor differences in the js file which creates the response. The main difference is the omission of Json.Parse and also changing the response headers.</p>

<p>Above examples can be cloned from my GitHub repository <a href="https://github.com/abygeorgea/MountebankExamples">here</a>. After cloning the repository to local, just run RunMounteBankStubsWithSOAPXMLStubExampleData.bat file. Postman scripts can also be found inside PostmanCollections Folder to testing this</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Aby George A</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-04-27T05:55:51+10:00"  data-updated="true" itemprop="datePublished dateCreated">27 Apr, 2017</time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/mountebank/'>mountebank</a>, <a class='category' href='/blog/categories/service-virtualisation/'>service virtualisation</a>
  
</span>


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.abygeorgea.com/blog/2017/04/27/stubbing-xml-responses-using-mountebank/" data-via="" data-counturl="http://www.abygeorgea.com/blog/2017/04/27/stubbing-xml-responses-using-mountebank/" >Tweet</a>
  
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/" title="Previous Post: Mountebank - Creating a response based on a file template and modifying it based on request - PART 2">&laquo; Mountebank - Creating a response based on a file template and modifying it based on request - PART 2</a></li>
            
            
            <li class="next"><a href="/blog/2017/05/02/powershell-remove-entire-directory-and-its-content/" title="Next Post: Powershell - Remove entire directory and it's content">Powershell - Remove entire directory and it's content &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/specflow/index.html">
        <span class="badge">4</span>
        specflow
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/element-identification/index.html">
        <span class="badge">3</span>
        element identification
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium/index.html">
        <span class="badge">3</span>
        selenium
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/git/index.html">
        <span class="badge">1</span>
        git
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/mountebank/index.html">
        <span class="badge">5</span>
        mountebank
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualisation/index.html">
        <span class="badge">5</span>
        service virtualisation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/powershell/index.html">
        <span class="badge">1</span>
        powershell
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octopress/index.html">
        <span class="badge">1</span>
        octopress
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octostrap3/index.html">
        <span class="badge">1</span>
        octostrap3
      </a>
    
  </div>
</section><section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2017/05/20/migrating-to-octopress/">Migrating to Octopress</a>
    
    <a class="list-group-item " href="/blog/2017/05/02/powershell-remove-entire-directory-and-its-content/">Powershell - Remove Entire Directory and It's Content</a>
    
    <a class="list-group-item active" href="/blog/2017/04/27/stubbing-xml-responses-using-mountebank/">Stubbing XML Responses Using Mountebank</a>
    
    <a class="list-group-item " href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">Mountebank - Creating a Response Based on a File Template and Modifying It Based on Request - PART 2</a>
    
    <a class="list-group-item " href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/">Mountebank - Creating a Response Based on a File Template and Modifying It Based on Request - PART 1</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'abygeorgea',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2017 - Aby George A<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


	
  </body>
</html>
