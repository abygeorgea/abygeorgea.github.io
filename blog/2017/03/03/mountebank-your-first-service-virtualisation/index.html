<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Mountebank - Your First Service Virtualisation - Aby George A</title>
  <meta name="author" content="Aby George A">

  <meta name="description" content="How to use Mountebank for stubbing responses">
  <meta name="keywords" content="Mountebank , Stub , Service Virtualisation">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Aby George A" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/">
  <meta property="og:title" content="Mountebank - Your First Service Virtualisation - Aby George A">
  <meta property="og:description" content="How to use Mountebank for stubbing responses">

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-99127431-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Aby George A</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
				<li >
                    <a href="/resources">Resources</a>
                </li>
				<li >
                    <a href="/about">About Me</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.abygeorgea.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Aby George A" />
    <meta itemprop="description" content="My thoughts on Test Automation . This blog is mainly for documenting my learning on Test automation . I intend to have this as a go to location for finding solutions for the problem faced by me in past . Hopefully this will help others as well." />
    <meta itemprop="url" content="http://www.abygeorgea.com" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-03-03T11:46:48+00:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 Mar, 2017</time>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Mountebank - Your First Service Virtualisation
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>In current development world, there will be scenarios were both API and its consumers are developed in parallel. Inorder to decouple their dependencies, we can mock an api response using mountebank. In this example, I will explain how to get started with your first service virtualisation using mountebank. After installing mountebank as mentioned in <a href="/blog/2017/02/13/service-virtualisation-using-mountebank/">here (Install Mountebank)</a>, we will proceed with configuring mountebank. It can be done in few ways. The method which I explain below is by using file based configuration. This involve setting up an imposter file and a stub response</p>

<h2>How to Create a Stub</h2>

<ol>
<li><p>Navigate to mountebank installation path</p></li>
<li><p>Create a folder and name it as &ldquo;StubResponse&rdquo;. ( You can name it whatever you want)</p></li>
<li><p>Create two json file using notepad and save it as &ldquo;MockResponeForApiOne.json&rdquo; and &ldquo;MockResponeForApiTwo.json&rdquo;( Or what ever you want).</p></li>
<li><p>Copy paste below code to &ldquo;MockResponeForApiOne.json&rdquo; . Sample example only. Update the response and predicates to suite your need ( if required)</p></li>
</ol>


<figure class='code'><figcaption><span>MockResponseForApiOne.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>"responses": [
</span><span class='line'> {
</span><span class='line'> "is": {
</span><span class='line'> "statusCode": 200,
</span><span class='line'> "body": {
</span><span class='line'> "Text":"Response ONE ","token":"username","expires_in":90
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ],
</span><span class='line'> "predicates": [
</span><span class='line'> {
</span><span class='line'> "exists": {
</span><span class='line'> "body" :
</span><span class='line'> {
</span><span class='line'> "username": true,"password" : true
</span><span class='line'> },
</span><span class='line'> "method" : "POST",
</span><span class='line'> "path" : "/Apitesting/v1/test?type=ResponseOne"
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ]</span></code></pre></td></tr></table></div></figure>


<p>-</p>

<ol>
<li>Copy paste below code to &ldquo;MockResponeForApiTwo.json&rdquo; . Sample example only. Update the response and predicates to suite your need ( if required)</li>
</ol>


<figure class='code'><figcaption><span>MockResponseForApiTwo.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> "responses": [
</span><span class='line'> {
</span><span class='line'> "is": {
</span><span class='line'> "statusCode": 200,
</span><span class='line'> "body": {
</span><span class='line'> "Text":"Response TWO ","token":"emailAddress","expires_in":90
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ],
</span><span class='line'> "predicates": [
</span><span class='line'> {
</span><span class='line'> "exists": {
</span><span class='line'> "body" :
</span><span class='line'> {
</span><span class='line'> "email": true,"password" : true
</span><span class='line'> },
</span><span class='line'> "method" : "POST",
</span><span class='line'> "path" : "/Apitesting/v1/test?type=ResponseTwo"
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ]</span></code></pre></td></tr></table></div></figure>


<h2>How to create an Imposter</h2>

<ol>
<li><p>Create another file called test.json in same path as above</p></li>
<li><p>copy and paste below contents to it</p></li>
</ol>


<figure class='code'><figcaption><span>test.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>{
</span><span class='line'>"imposters": [
</span><span class='line'>{
</span><span class='line'>"port": 4547,
</span><span class='line'>"protocol": "http",
</span><span class='line'>"stubs": [
</span><span class='line'>{
</span><span class='line'>&lt;% include MockResponseForApiOne.json %&gt;
</span><span class='line'>},
</span><span class='line'>{
</span><span class='line'>&lt;% include MockResponseForApiTwo.json %&gt;
</span><span class='line'>}
</span><span class='line'>]
</span><span class='line'>}
</span><span class='line'>]
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<h2>Let us have a close look into Imposter and stubs</h2>

<p>Responses – Contains an array of responses expected to return for the defined stub. In the above scenario the response will include status code as 200 and response body. For more info, <a href="http://www.mbtest.org/docs/api/contracts">http://www.mbtest.org/docs/api/contracts</a>
Predicates – is an array of predicates which will be used during matching process. Predicate object can be quite complex, it supports lots of different matching techniques.
For more info, <a href="http://www.mbtest.org/docs/api/predicates">http://www.mbtest.org/docs/api/predicates</a></p>

<h2>Let&rsquo;s Mock it</h2>

<p>Once all required files are created and saved, mountebank can be started by following command in command prompt , after navigating to installation folder of mountebank</p>

<figure class='code'><figcaption><span>test.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>mb --configfile StubResponse/test.json
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://automationtestingtips.files.wordpress.com/2017/03/cmd.jpg" alt="cmd.jpg" /></p>

<p>Once mountebank is started, we can verify it by navigating to path <a href="http://localhost:2525/imposters">http://localhost:2525/imposters</a></p>

<p>It will list out all active ports and a list of stubs available</p>

<p><img src="https://automationtestingtips.files.wordpress.com/2017/03/imposter.jpg" alt="imposter" /></p>

<h2>Test It</h2>

<p>Once we complete above steps, mountebank is ready with stubs. Now comes the part to test it and use. You can use any api testing tool ( Postman, soapUi etc ) for testing this. Just send the request matching the predicates and look for the responses</p>

<p>Below are the screenshot of Postman request</p>

<p><strong>Requesting for First API.</strong></p>

<p>Predicate of response One says that , request has to be of type POST, body of request should have &ldquo;username&rdquo; and &ldquo;password&rdquo; . Path of the request should have /Apitesting/v1/test?type=ResponseOne"</p>

<p>Now construct a postman request matching above and fire it</p>

<p><img src="https://automationtestingtips.files.wordpress.com/2017/03/bgone.jpg" alt="bgone" /></p>

<p><strong>Request for second API</strong></p>

<p>Predicate of response One says that , request has to be of type POST, body of request should have &ldquo;<strong>email</strong>&rdquo; and &ldquo;password&rdquo; . Path of the request should have /Apitesting/v1/test?type=Response<strong>Two</strong>"</p>

<p>Now construct a postman request matching above and fire it</p>

<p><img src="https://automationtestingtips.files.wordpress.com/2017/03/bgtwo.jpg" alt="bgtwo" /></p>

<p>As you can see, both request has succesfully received expected response message</p>

<p>For actual development usage, just point your application to this localhost URL and start consuming virtualised API</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Aby George A</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-03-03T11:46:48+00:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 Mar, 2017</time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/mountebank/'>mountebank</a>, <a class='category' href='/blog/categories/service-virtualisation/'>service virtualisation</a>
  
</span>


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/" data-via="" data-counturl="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/" >Tweet</a>
  
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2017/02/13/service-virtualisation-using-mountebank/" title="Previous Post: Service Virtualisation Using Mountebank">&laquo; Service Virtualisation Using Mountebank</a></li>
            
            
            <li class="next"><a href="/blog/2017/04/06/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/" title="Next Post: Mountebank - Creating a response based on a file template and modifying it based on request - PART 1">Mountebank - Creating a response based on a file template and modifying it based on request - PART 1 &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h2>Comments</h2>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/codesnippets/index.html">
        <span class="badge">5</span>
        codesnippets
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/java/index.html">
        <span class="badge">2</span>
        java
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/excel/index.html">
        <span class="badge">3</span>
        excel
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium/index.html">
        <span class="badge">4</span>
        selenium
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/volunteering/index.html">
        <span class="badge">1</span>
        volunteering
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/nodejs/index.html">
        <span class="badge">1</span>
        nodejs
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/data-driven-testing-framework/index.html">
        <span class="badge">3</span>
        data driven testing framework
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/selenium-webdriver/index.html">
        <span class="badge">3</span>
        selenium webdriver
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/xml/index.html">
        <span class="badge">1</span>
        xml
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/specflow/index.html">
        <span class="badge">4</span>
        specflow
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/bdd/index.html">
        <span class="badge">1</span>
        bdd
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/element-identification/index.html">
        <span class="badge">4</span>
        element identification
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/nunit/index.html">
        <span class="badge">1</span>
        nunit
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/git/index.html">
        <span class="badge">2</span>
        git
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/powershell/index.html">
        <span class="badge">2</span>
        powershell
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/mountebank/index.html">
        <span class="badge">8</span>
        mountebank
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualisation/index.html">
        <span class="badge">5</span>
        service virtualisation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octopress/index.html">
        <span class="badge">1</span>
        octopress
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/octostrap3/index.html">
        <span class="badge">1</span>
        octostrap3
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/galen/index.html">
        <span class="badge">2</span>
        galen
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/javascript/index.html">
        <span class="badge">1</span>
        javascript
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/postman/index.html">
        <span class="badge">3</span>
        postman
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/newman/index.html">
        <span class="badge">3</span>
        newman
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/conference/index.html">
        <span class="badge">1</span>
        conference
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/test/index.html">
        <span class="badge">1</span>
        test
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/automation/index.html">
        <span class="badge">1</span>
        automation
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/agile/index.html">
        <span class="badge">1</span>
        agile
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/service-virtualization/index.html">
        <span class="badge">1</span>
        service virtualization
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/accessibility/index.html">
        <span class="badge">1</span>
        accessibility
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/testing/index.html">
        <span class="badge">1</span>
        testing
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/team-city/index.html">
        <span class="badge">1</span>
        team city
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/metrics/index.html">
        <span class="badge">1</span>
        metrics
      </a>
    
  </div>
</section><section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2018/03/01/extracting-metrics-from-teamcity/">Extracting Metrics From TeamCity</a>
    
    <a class="list-group-item " href="/blog/2018/03/01/automating-accessibility-testing/">Automate Accessibility Testing Using aXe</a>
    
    <a class="list-group-item " href="/blog/2017/11/16/mountebank-adding-delay-to-response/">Mountebank - Adding Delay to Response</a>
    
    <a class="list-group-item " href="/blog/2017/10/24/blog-traffic/">Highlights of Past One Month</a>
    
    <a class="list-group-item " href="/blog/2017/09/22/taking-emotions-out-of-sprint-retrospective/">Taking Emotions Out of Sprint Retrospective</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'abygeorgea',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2018 - Aby George A<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'abygeorgea';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/';
        var disqus_url = 'http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


	
  </body>
</html>
