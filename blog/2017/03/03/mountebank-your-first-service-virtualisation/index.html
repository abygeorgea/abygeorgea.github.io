<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Mountebank - Your First Service Virtualisation - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/">
  <meta property="og:title" content="Mountebank - Your First Service Virtualisation - My Octopress Blog">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  

</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">My Octopress Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.abygeorgea.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="My Octopress Blog" />
    
    <meta itemprop="url" content="http://www.abygeorgea.com" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-03-03T22:46:48+11:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 Mar, 2017</time>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Mountebank - Your First Service Virtualisation
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>In current development world, there will be scenarios were both API and its consumers are developed in parallel. Inorder to decouple their dependencies, we can mock an api response using mountebank. In this example, I will explain how to get started with your first service virtualisation using mountebank. After installing mountebank as mentioned in <a href="/blog/2017/02/13/service-virtualisation-using-mountebank/">here (Install Mountebank)</a>, we will proceed with configuring mountebank. It can be done in few ways. The method which I explain below is by using file based configuration. This involve setting up an imposter file and a stub response</p>

<h2>How to Create a Stub</h2>

<ol>
<li><p>Navigate to mountebank installation path</p></li>
<li><p>Create a folder and name it as &ldquo;StubResponse&rdquo;. ( You can name it whatever you want)</p></li>
<li><p>Create two json file using notepad and save it as &ldquo;MockResponeForApiOne.json&rdquo; and &ldquo;MockResponeForApiTwo.json&rdquo;( Or what ever you want).</p></li>
<li><p>Copy paste below code to &ldquo;MockResponeForApiOne.json&rdquo; . Sample example only. Update the response and predicates to suite your need ( if required)</p></li>
</ol>


<figure class='code'><figcaption><span>MockResponseForApiOne.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>"responses": [
</span><span class='line'> {
</span><span class='line'> "is": {
</span><span class='line'> "statusCode": 200,
</span><span class='line'> "body": {
</span><span class='line'> "Text":"Response ONE ","token":"username","expires_in":90
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ],
</span><span class='line'> "predicates": [
</span><span class='line'> {
</span><span class='line'> "exists": {
</span><span class='line'> "body" :
</span><span class='line'> {
</span><span class='line'> "username": true,"password" : true
</span><span class='line'> },
</span><span class='line'> "method" : "POST",
</span><span class='line'> "path" : "/Apitesting/v1/test?type=ResponseOne"
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ]</span></code></pre></td></tr></table></div></figure>


<p>-</p>

<ol>
<li>Copy paste below code to &ldquo;MockResponeForApiTwo.json&rdquo; . Sample example only. Update the response and predicates to suite your need ( if required)</li>
</ol>


<figure class='code'><figcaption><span>MockResponseForApiTwo.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> "responses": [
</span><span class='line'> {
</span><span class='line'> "is": {
</span><span class='line'> "statusCode": 200,
</span><span class='line'> "body": {
</span><span class='line'> "Text":"Response TWO ","token":"emailAddress","expires_in":90
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ],
</span><span class='line'> "predicates": [
</span><span class='line'> {
</span><span class='line'> "exists": {
</span><span class='line'> "body" :
</span><span class='line'> {
</span><span class='line'> "email": true,"password" : true
</span><span class='line'> },
</span><span class='line'> "method" : "POST",
</span><span class='line'> "path" : "/Apitesting/v1/test?type=ResponseTwo"
</span><span class='line'> }
</span><span class='line'> }
</span><span class='line'> ]</span></code></pre></td></tr></table></div></figure>


<h2>How to create an Imposter</h2>

<ol>
<li><p>Create another file called test.json in same path as above</p></li>
<li><p>copy and paste below contents to it</p></li>
</ol>


<figure class='code'><figcaption><span>test.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>{
</span><span class='line'>"imposters": [
</span><span class='line'>{
</span><span class='line'>"port": 4547,
</span><span class='line'>"protocol": "http",
</span><span class='line'>"stubs": [
</span><span class='line'>{
</span><span class='line'>&lt;% include MockResponseForApiOne.json %&gt;
</span><span class='line'>},
</span><span class='line'>{
</span><span class='line'>&lt;% include MockResponseForApiTwo.json %&gt;
</span><span class='line'>}
</span><span class='line'>]
</span><span class='line'>}
</span><span class='line'>]
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<h2>Let us have a close look into Imposter and stubs</h2>

<p>Responses – Contains an array of responses expected to return for the defined stub. In the above scenario the response will include status code as 200 and response body. For more info, <a href="http://www.mbtest.org/docs/api/contracts">http://www.mbtest.org/docs/api/contracts</a>
Predicates – is an array of predicates which will be used during matching process. Predicate object can be quite complex, it supports lots of different matching techniques.
For more info, <a href="http://www.mbtest.org/docs/api/predicates">http://www.mbtest.org/docs/api/predicates</a></p>

<h2>Let&rsquo;s Mock it</h2>

<p>Once all required files are created and saved, mountebank can be started by following command in command prompt , after navigating to installation folder of mountebank</p>

<figure class='code'><figcaption><span>test.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>mb --configfile StubResponse/test.json
</span></code></pre></td></tr></table></div></figure>


<p><img src="https://seleniumtestingtips.files.wordpress.com/2017/03/cmd.jpg" alt="cmd.jpg" /></p>

<p>Once mountebank is started, we can verify it by navigating to path <a href="http://localhost:2525/imposters">http://localhost:2525/imposters</a></p>

<p>It will list out all active ports and a list of stubs available</p>

<p><img src="https://seleniumtestingtips.files.wordpress.com/2017/03/imposter.jpg" alt="imposter" /></p>

<h2>Test It</h2>

<p>Once we complete above steps, mountebank is ready with stubs. Now comes the part to test it and use. You can use any api testing tool ( Postman, soapUi etc ) for testing this. Just send the request matching the predicates and look for the responses</p>

<p>Below are the screenshot of Postman request</p>

<p><strong>Requesting for First API.</strong></p>

<p>Predicate of response One says that , request has to be of type POST, body of request should have &ldquo;username&rdquo; and &ldquo;password&rdquo; . Path of the request should have /Apitesting/v1/test?type=ResponseOne"</p>

<p>Now construct a postman request matching above and fire it</p>

<p><img src="https://seleniumtestingtips.files.wordpress.com/2017/03/bgone.jpg" alt="bgone" /></p>

<p><strong>Request for second API</strong></p>

<p>Predicate of response One says that , request has to be of type POST, body of request should have &ldquo;<strong>email</strong>&rdquo; and &ldquo;password&rdquo; . Path of the request should have /Apitesting/v1/test?type=Response<strong>Two</strong>"</p>

<p>Now construct a postman request matching above and fire it</p>

<p><img src="http://automationtestingtips.files.wordpress.com/2017/03/bgtwo.jpg" alt="bgtwo" /></p>

<p>As you can see, both request has succesfully received expected response message</p>

<p>For actual development usage, just point your application to this localhost URL and start consuming virtualised API</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Aby George A</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2017-03-03T22:46:48+11:00"  data-updated="true" itemprop="datePublished dateCreated"> 3 Mar, 2017</time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/mountebank/'>mountebank</a>, <a class='category' href='/blog/categories/service-virtualisation/'>service virtualisation</a>
  
</span>


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/" data-via="" data-counturl="http://www.abygeorgea.com/blog/2017/03/03/mountebank-your-first-service-virtualisation/" >Tweet</a>
  
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2017/02/13/service-virtualisation-using-mountebank/" title="Previous Post: Service Virtualisation Using Mountebank">&laquo; Service Virtualisation Using Mountebank</a></li>
            
            
            <li class="next"><a href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/" title="Next Post: Mountebank - Creating a response based on a file template and modifying it based on request - PART 1">Mountebank - Creating a response based on a file template and modifying it based on request - PART 1 &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">Mountebank - Creating a Response Based on a File Template and Modifying It Based on Request - PART 2</a>
    
    <a class="list-group-item " href="/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/">Mountebank - Creating a Response Based on a File Template and Modifying It Based on Request - PART 1</a>
    
    <a class="list-group-item active" href="/blog/2017/03/03/mountebank-your-first-service-virtualisation/">Mountebank - Your First Service Virtualisation</a>
    
    <a class="list-group-item " href="/blog/2017/02/13/service-virtualisation-using-mountebank/">Service Virtualisation Using Mountebank</a>
    
    <a class="list-group-item " href="/blog/2016/09/06/how-to-take-screenshots-with-selenium-in-c/">How to Take Screenshots With Selenium in C#</a>
    
  </div>
</section>






    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2017 - Your Name<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


  </body>
</html>
