<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Selenium Webdriver | Aby George A]]></title>
  <link href="http://www.abygeorgea.com/blog/categories/selenium-webdriver/atom.xml" rel="self"/>
  <link href="http://www.abygeorgea.com/"/>
  <updated>2017-08-29T22:25:41+10:00</updated>
  <id>http://www.abygeorgea.com/</id>
  <author>
    <name><![CDATA[Aby George A]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Specflow - Sharing Data Between Steps]]></title>
    <link href="http://www.abygeorgea.com/blog/2016/08/01/specflow-sharing-data-between-steps/"/>
    <updated>2016-08-01T02:12:23+00:00</updated>
    <id>http://www.abygeorgea.com/blog/2016/08/01/specflow-sharing-data-between-steps</id>
    <content type="html"><![CDATA[<p>In Specflow, Step definitions are global. So a scenario can have multiple step definitions which can be present in different classes.  Sometimes, there arise a need to share the data between steps residing in different classes. How do we do it??</p>

<p>There are multiple ways to do it</p>

<ol>
<li><p>Context Injection</p></li>
<li><p>Feature Context</p></li>
<li><p>Scenario Context</p></li>
</ol>


<p>Let us look into more details about how to store and retrieve data using Scenario Context .</p>

<p><strong>ScenarioContext.Current</strong></p>

<p>How do we add a key value pair to Scenario Context ? It is as simple as below</p>

<pre><code>[Given(@"I have entered (.*) and (.*) into the Login Page")]
public void GivenIHaveEnteredAndIntoTheLoginPage(string p0, string p1)
 {
 ScenarioContext.Current.Add("username", p0);
 ScenarioContext.Current.Add("password", p1);
 }
</code></pre>

<p>How do we retrieve the value from ScenarioContext ?</p>

<pre><code>When(@"I press retrieve data")]
public void WhenIRetrieveData()
{
string username = (string)ScenarioContext.Current["username"];
string password = (string)ScenarioContext.Current["password"];

}
</code></pre>

<p>Note: While retrieving , scenarioContext.Current always return an object . Hence we need use explicit casting while retrieving data from scenario context.</p>

<p>In Nut Shell,</p>

<blockquote>**Set a value for a key ( Store data ) **
ScenarioContext.Current.Add(string key, object value);

**Get a value of the key ( Retrieve data) **
var value =(Type) ScenarioContext.Current.[string Key];

var value = ScenarioContext.Current.Get(string Key);</blockquote>


<p>We can use this for storing and passing objects as well</p>

<blockquote>Example of storing webdriver object is as below.(where "browser" is current webdriver object )

ScenarioContext.Current.Add("driver1", browser);

IWebDriver driver2 = (IWebDriver)ScenarioContext.Current["driver1"];</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Data Driven Framework - XML]]></title>
    <link href="http://www.abygeorgea.com/blog/2016/07/29/data-driven-framework-xml/"/>
    <updated>2016-07-29T22:10:02+00:00</updated>
    <id>http://www.abygeorgea.com/blog/2016/07/29/data-driven-framework-xml</id>
    <content type="html"><![CDATA[<p>I am not going to explain what is data driven framework or what is its benefits.  All of them are pretty well-known . If not, just google it.</p>

<p>Here I am going to explain a sample code which can be used to read from xml data files. This will be helpful to implement a data driven frame work for BDD testing , using Specflow or Cucumber</p>

<h2>Pre - requiste</h2>

<p>Code is written in Csharp . We need to add below reference to visual studio solution</p>

<ol>
<li><p>Add reference to System.xml</p></li>
<li><p>Add reference to System.Xml.Linq</p></li>
</ol>


<h2><strong>XML Format</strong></h2>

<p>[code language=&ldquo;xml&rdquo; ]</p>

<p>[/code]</p>

<p>Node names in above example are Scenario1, Scenario2 and Scenario3</p>

<p>Element or Attribute name are username, password, Email .</p>

<p>You can add any number of nodes and attributes depending on the test scenario</p>

<h2><strong>Read specific Value from XML</strong></h2>

<p>Below code provides a solution to read values of existing Key/Attribute from a specific node.</p>

<pre><code>public static string ReadDataFromXML(string FileName, string NodeName, string KeyName)
{
 string _basePath = AppDomain.CurrentDomain.BaseDirectory.ToString();
string _datafilePath = _basePath + @"..\..\Data\" + FileName;
XDocument xmlDoc = XDocument.Load(_datafilePath);
data = xmlDoc.Root.Element(NodeName).Attribute(KeyName).Value;
return data;
}
</code></pre>

<p> </p>

<h2>Read All values for a Scenario from XML</h2>

<p>This code gives a solution for reading details of all attributes/key from a node. This comes very handy for reading all data required for a scenario and adding them to scenario context , so that data can be shared across specflow/cucumber step definitions</p>

<pre><code>public static void ReadAllDataFromXml(string xFileName, string xNodeName)
{
 string data = string.Empty;
// Load path of xml file . Data Folder in below is folder name
string _basePath = AppDomain.CurrentDomain.BaseDirectory.ToString();
string _datafilePath = _basePath + @"..\..\Data\" + xFileName;
XDocument xmlDoc = XDocument.Load(_datafilePath);

var cols = xmlDoc.Descendants(xNodeName).First();

foreach (XAttribute xAtt in cols.Attributes())
{
Console.WriteLine("{0},{1}", xAtt.Name, xAtt.Value); // --printing values --
string temp = xAtt.Name.ToString();
ScenarioContext.Current.Add(temp, xAtt.Value);
// The values are added to scenario context as key value pair.can be modified
}
</code></pre>

<h2>Write Data into XML</h2>

<p>  Below function gives a solution to update value on an existing key/attribute in data sheet . Sometime the data sheet will be copied over to bin folder when we build the solution. That makes it necessary to update both original data sheet and the one in bin folder  so that modified data can be used in same test without another rebuild.</p>

<pre><code>public void WriteIntoXML(string xData, string xElement, string xAttribute, string xFileName)
{
 // This solution updates value of an existing key.
 // Xdoc refers to the xmlsheet in the Solution explorer
 // xDoc_2 refers to the xmlsheet inside bin folder while running

 // This solution write them separately in below code.
 // Below is the path to xml file after building solution
 XDocument xDoc_2 = XDocument.Load(Path.Combine(Environment.CurrentDirectory, "Data Folder", xFileName));

 //Below should be the path of xml file
 XDocument xDoc = XDocument.Load(Path.Combine(Path.GetFullPath(@"../../Data Folder"), xFileName));
 xDoc_2.Root.Element(xElement).Attribute(xAttribute).Value = data.ToString();
 xDoc.Root.Element(xElement).Attribute(xAttribute).Value = data.ToString();
 xDoc_2.Save(Path.Combine(Environment.CurrentDirectory, "Data Folder", xFileName));
 xDoc.Save(Path.Combine(Path.GetFullPath(@"../../Data Folder"), xFileName));
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Data Driven Framework - Excel]]></title>
    <link href="http://www.abygeorgea.com/blog/2016/07/30/data-driven-framework-excel/"/>
    <updated>2016-07-30T05:49:22+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2016/07/30/data-driven-framework-excel</id>
    <content type="html"><![CDATA[<p>In previous blog post, I have explained about how use XML for making a data driven framework for automation testing . It can be found <a href="/blog/2016/07/29/data-driven-framework-xml/">here</a>. I have also written about how to use jxl library for <a href="/blog/2014/06/01/java-reading-a-specific-cell-in-excel/">reading from excel</a> and <a href="/blog/2014/06/01/java-writing-into-specific-cell-in-excel/">writing into Excel</a>.</p>

<p>Below is another code snippet to read all values of a row and save it into a hash map for accessing later during automation test.</p>

<pre><code class="Java">public  HashMap GetAllDataForARow  (String sheet, int Row){
        HashMap DataMap = new HashMap();
        try {
            Workbook wrk1 =  Workbook.getWorkbook(new File(dataPath));

            //Obtain the reference to the first sheet in the workbook
            Sheet sheet1 = wrk1.getSheet(sheet);
            int x =0;


            Cell colArow1 , colArow2;
            do {
                colArow1 = sheet1.getCell(x,0);
                colArow2 = sheet1.getCell(x,Row);
                DataMap.put(colArow1.getContents(), colArow2.getContents());
                x=x+1;
            }while (colArow1.getContents() != "");

        }

        catch (BiffException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }catch (IndexOutOfBoundsException e){
        }
        return DataMap;

    }
</code></pre>
]]></content>
  </entry>
  
</feed>
