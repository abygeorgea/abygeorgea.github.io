<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Aby George A]]></title>
  <link href="http://www.abygeorgea.com/atom.xml" rel="self"/>
  <link href="http://www.abygeorgea.com/"/>
  <updated>2018-09-08T23:18:07+10:00</updated>
  <id>http://www.abygeorgea.com/</id>
  <author>
    <name><![CDATA[Aby George A]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Running Command Line in Remote Machine Using WMI]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/09/08/running-command-line-in-remote-machine-using-wmi/"/>
    <updated>2018-09-08T21:47:52+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/09/08/running-command-line-in-remote-machine-using-wmi</id>
    <content type="html"><![CDATA[<p>Recently I had to find a way for running a command line process in server. I had to spend fair bit of time googling for various approaches of doing it. Most of them are by using PSExec.  However there is another approach of using WMI (Windows Management Instrumentation) . Below is one of the approach , which I found at <a href="https://blogs.msdn.microsoft.com/padmanr/2010/05/08/execute-a-process-on-remote-machine-wait-for-it-to-exit-and-retrieve-its-exit-code-using-wmi/">msdn blog</a>.</p>

<p>Below method can be accessed anywhere by</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ProcessWMI p = new ProcessWMI();
</span><span class='line'>p.ExecuteRemoteProcessWMI(remoteMachine, sBatFile, timeout);</span></code></pre></td></tr></table></div></figure>


<p>The solution has multiple parts as follows</p>

<ol>
<li>Connect to remote machine using remote machine Name, user name and password</li>
<li>Start the remote process. Win32 process and pass the command to be run</li>
<li>Find if the remote process is running and if it does, start an event monitor to wait for it to exit</li>
<li>Once the process exits, retrieve its exit code</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
</pre></td><td class='code'><pre><code class='Csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">ProcessWMI</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">uint</span> <span class="n">ProcessId</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">ExitCode</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">bool</span> <span class="n">EventArrived</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">ManualResetEvent</span> <span class="n">mre</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManualResetEvent</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessStoptEventArrived</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArrivedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">((</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ProcessId&quot;</span><span class="p">].</span><span class="n">Value</span> <span class="p">==</span> <span class="n">ProcessId</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Process: {0}, Stopped with Code: {1}&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ProcessId&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ExitStatus&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
</span><span class='line'>            <span class="n">ExitCode</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="kt">uint</span><span class="p">)</span><span class="n">e</span><span class="p">.</span><span class="n">NewEvent</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&quot;ExitStatus&quot;</span><span class="p">].</span><span class="n">Value</span><span class="p">;</span>
</span><span class='line'>            <span class="n">EventArrived</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>            <span class="n">mre</span><span class="p">.</span><span class="n">Set</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">ProcessWMI</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="n">ProcessId</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="n">ExitCode</span> <span class="p">=</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
</span><span class='line'>        <span class="n">EventArrived</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">ExecuteRemoteProcessWMI</span><span class="p">(</span><span class="kt">string</span> <span class="n">remoteComputerName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arguments</span><span class="p">,</span> <span class="kt">int</span> <span class="n">WaitTimePerCommand</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">string</span> <span class="n">strUserName</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span><span class='line'>        <span class="k">try</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">ConnectionOptions</span> <span class="n">connOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ConnectionOptions</span><span class="p">();</span>
</span><span class='line'>            <span class="c1">//Note: This will connect  using below credentials. If not provided, it will be based on logged in user</span>
</span><span class='line'>             <span class="n">connOptions</span><span class="p">.</span><span class="n">Username</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineLogonUser&quot;</span><span class="p">];</span>
</span><span class='line'>             <span class="n">connOptions</span><span class="p">.</span><span class="n">Password</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineUserPassword&quot;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">connOptions</span><span class="p">.</span><span class="n">Impersonation</span> <span class="p">=</span> <span class="n">ImpersonationLevel</span><span class="p">.</span><span class="n">Impersonate</span><span class="p">;</span>
</span><span class='line'>            <span class="n">connOptions</span><span class="p">.</span><span class="n">EnablePrivileges</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>            <span class="n">ManagementScope</span> <span class="n">manScope</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementScope</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">@&quot;\\{0}\ROOT\CIMV2&quot;</span><span class="p">,</span> <span class="n">remoteComputerName</span><span class="p">),</span> <span class="n">connOptions</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">try</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">manScope</span><span class="p">.</span><span class="n">Connect</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Management Connect to remote machine &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span> <span class="p">+</span> <span class="s">&quot; as user &quot;</span> <span class="p">+</span> <span class="n">strUserName</span> <span class="p">+</span> <span class="s">&quot; failed with the following error &quot;</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">ObjectGetOptions</span> <span class="n">objectGetOptions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ObjectGetOptions</span><span class="p">();</span>
</span><span class='line'>            <span class="n">ManagementPath</span> <span class="n">managementPath</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementPath</span><span class="p">(</span><span class="s">&quot;Win32_Process&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementClass</span> <span class="n">processClass</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementClass</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">managementPath</span><span class="p">,</span> <span class="n">objectGetOptions</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementBaseObject</span> <span class="n">inParams</span> <span class="p">=</span> <span class="n">processClass</span><span class="p">.</span><span class="n">GetMethodParameters</span><span class="p">(</span><span class="s">&quot;Create&quot;</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">inParams</span><span class="p">[</span><span class="s">&quot;CommandLine&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">arguments</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">using</span> <span class="p">(</span><span class="n">ManagementBaseObject</span> <span class="n">outParams</span> <span class="p">=</span> <span class="n">processClass</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">(</span><span class="s">&quot;Create&quot;</span><span class="p">,</span> <span class="n">inParams</span><span class="p">,</span> <span class="k">null</span><span class="p">))</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>                        <span class="k">if</span> <span class="p">((</span><span class="kt">uint</span><span class="p">)</span><span class="n">outParams</span><span class="p">[</span><span class="s">&quot;returnValue&quot;</span><span class="p">]</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">{</span>
</span><span class='line'>                            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Error while starting process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; creation returned an exit code of &quot;</span> <span class="p">+</span> <span class="n">outParams</span><span class="p">[</span><span class="s">&quot;returnValue&quot;</span><span class="p">]</span> <span class="p">+</span> <span class="s">&quot;. It was launched as &quot;</span> <span class="p">+</span> <span class="n">strUserName</span> <span class="p">+</span> <span class="s">&quot; on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                        <span class="k">this</span><span class="p">.</span><span class="n">ProcessId</span> <span class="p">=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">outParams</span><span class="p">[</span><span class="s">&quot;processId&quot;</span><span class="p">];</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">SelectQuery</span> <span class="n">CheckProcess</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="s">&quot;Select * from Win32_Process Where ProcessId = &quot;</span> <span class="p">+</span> <span class="n">ProcessId</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectSearcher</span> <span class="n">ProcessSearcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementObjectSearcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">CheckProcess</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectCollection</span> <span class="n">MoC</span> <span class="p">=</span> <span class="n">ProcessSearcher</span><span class="p">.</span><span class="n">Get</span><span class="p">())</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">MoC</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;ERROR AS WARNING: Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; terminated before it could be tracked on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">WqlEventQuery</span> <span class="n">q</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WqlEventQuery</span><span class="p">(</span><span class="s">&quot;Win32_ProcessStopTrace&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">ManagementEventWatcher</span> <span class="n">w</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementEventWatcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">w</span><span class="p">.</span><span class="n">EventArrived</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventArrivedEventHandler</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ProcessStoptEventArrived</span><span class="p">);</span>
</span><span class='line'>                <span class="n">w</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(!</span><span class="n">mre</span><span class="p">.</span><span class="n">WaitOne</span><span class="p">(</span><span class="n">WaitTimePerCommand</span><span class="p">,</span><span class="k">false</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">w</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>                    <span class="k">this</span><span class="p">.</span><span class="n">EventArrived</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                    <span class="n">w</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">EventArrived</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">SelectQuery</span> <span class="n">sq</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SelectQuery</span><span class="p">(</span><span class="s">&quot;Select * from Win32_Process Where ProcessId = &quot;</span> <span class="p">+</span> <span class="n">ProcessId</span><span class="p">);</span>
</span><span class='line'>                <span class="k">using</span> <span class="p">(</span><span class="n">ManagementObjectSearcher</span> <span class="n">searcher</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ManagementObjectSearcher</span><span class="p">(</span><span class="n">manScope</span><span class="p">,</span> <span class="n">sq</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">foreach</span> <span class="p">(</span><span class="n">ManagementObject</span> <span class="n">queryObj</span> <span class="k">in</span> <span class="n">searcher</span><span class="p">.</span><span class="n">Get</span><span class="p">())</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">queryObj</span><span class="p">.</span><span class="n">InvokeMethod</span><span class="p">(</span><span class="s">&quot;Terminate&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span><span class='line'>                        <span class="n">queryObj</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
</span><span class='line'>                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot; timed out and was killed on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">else</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ExitCode</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">&quot;Process &quot;</span> <span class="p">+</span> <span class="n">arguments</span> <span class="p">+</span> <span class="s">&quot;exited with exit code &quot;</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">ExitCode</span> <span class="p">+</span> <span class="s">&quot; on &quot;</span> <span class="p">+</span> <span class="n">remoteComputerName</span> <span class="p">+</span> <span class="s">&quot; run as &quot;</span> <span class="p">+</span> <span class="n">strUserName</span><span class="p">);</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                    <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;process exited with Exit code 0&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;Execute process failed Machinename {0}, ProcessName {1}, RunAs {2}, Error is {3}, Stack trace {4}&quot;</span><span class="p">,</span> <span class="n">remoteComputerName</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">strUserName</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">StackTrace</span><span class="p">),</span> <span class="n">e</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Running Powershell Remotely]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/09/05/running-powershell-remotely/"/>
    <updated>2018-09-05T22:46:14+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/09/05/running-powershell-remotely</id>
    <content type="html"><![CDATA[<p>Code snippet for running power shell on a remote machine. Loosely based on blog post <a href="https://com2kid.wordpress.com/2011/09/22/remotely-executing-commands-in-powershell-using-c/">here</a> and <a href="https://www.codeproject.com/Articles/773685/Enable-Remote-PowerShell-Execution-in-Csharp">here</a></p>

<p>Add reference to System.Management.Automation</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System.Management.Automation</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Management.Automation.Runspaces</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">internal</span> <span class="k">void</span> <span class="nf">runPowershellRemotely</span><span class="p">(</span><span class="kt">string</span> <span class="n">location</span><span class="p">,</span> <span class="kt">string</span> <span class="n">scriptToBeRun</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">userName</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineLogonUser&quot;</span><span class="p">];</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">password</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachineUserPassword&quot;</span><span class="p">];</span>
</span><span class='line'>           <span class="kt">var</span> <span class="n">securestring</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SecureString</span><span class="p">();</span>
</span><span class='line'>            <span class="k">foreach</span> <span class="p">(</span><span class="n">Char</span> <span class="n">c</span> <span class="k">in</span> <span class="n">password</span><span class="p">){</span>
</span><span class='line'>                <span class="n">securestring</span><span class="p">.</span><span class="n">AppendChar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">PSCredential</span> <span class="n">creds</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PSCredential</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span> <span class="n">securestring</span><span class="p">);</span>
</span><span class='line'>            <span class="c1">// Remove logging if not needed</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Running Powershell {0} at location {1}&quot;</span><span class="p">,</span> <span class="n">scriptToBeRun</span><span class="p">,</span> <span class="n">location</span><span class="p">));</span>
</span><span class='line'>            <span class="n">WSManConnectionInfo</span> <span class="n">connectionInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WSManConnectionInfo</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>           <span class="n">connectionInfo</span><span class="p">.</span><span class="n">ComputerName</span> <span class="p">=</span> <span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;RemoteMachine&quot;</span><span class="p">];</span>
</span><span class='line'>            <span class="n">connectionInfo</span><span class="p">.</span><span class="n">Credential</span> <span class="p">=</span> <span class="n">creds</span><span class="p">;</span>
</span><span class='line'>            <span class="n">Runspace</span> <span class="n">runspace</span> <span class="p">=</span> <span class="n">RunspaceFactory</span><span class="p">.</span><span class="n">CreateRunspace</span><span class="p">(</span><span class="n">connectionInfo</span><span class="p">);</span>
</span><span class='line'>            <span class="n">runspace</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'>            <span class="k">using</span> <span class="p">(</span><span class="n">PowerShell</span> <span class="n">ps</span> <span class="p">=</span> <span class="n">PowerShell</span><span class="p">.</span><span class="n">Create</span><span class="p">())</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">Runspace</span> <span class="p">=</span> <span class="n">runspace</span><span class="p">;</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">AddScript</span><span class="p">(</span><span class="s">@&quot;cd &quot;</span><span class="p">+</span> <span class="n">location</span><span class="p">);</span>
</span><span class='line'>                <span class="n">ps</span><span class="p">.</span><span class="n">AddScript</span><span class="p">(</span><span class="n">scriptToBeRun</span><span class="p">);</span>
</span><span class='line'>                <span class="k">try</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="kt">var</span> <span class="n">results</span> <span class="p">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">Invoke</span><span class="p">();</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Results from Powershell Script is ---------------------------&quot;</span><span class="p">);</span>
</span><span class='line'>                    <span class="k">foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">x</span> <span class="k">in</span> <span class="n">results</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : End of results--------------------------------- ---------------------------&quot;</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">log</span><span class="p">.</span><span class="n">Error</span><span class="p">(</span><span class="s">&quot;\tPOWERSHEL : Exception from running Powershell Script is&quot;</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="n">runspace</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Working With Windows Services]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/09/03/working-with-windows-services/"/>
    <updated>2018-09-03T22:59:54+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/09/03/working-with-windows-services</id>
    <content type="html"><![CDATA[<p>Below is code snippet for working with windows service. It helps to find status of service, start , stop and restart as required.</p>

<p>We need to pass in details of windows services name ( as shown i services.msc ) and machine name(should be in same network).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System.ServiceProcess</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>          <span class="k">internal</span> <span class="kt">string</span> <span class="nf">FindStatus</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\tStatus of {0} service in {1} is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">internal</span> <span class="kt">string</span> <span class="nf">StopService</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">myService</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Running</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">Stop</span><span class="p">();</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">WaitForStatus</span><span class="p">(</span><span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Stopped</span><span class="p">);</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\t{0} service Stopped in {1}. Current Status is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">internal</span> <span class="kt">string</span> <span class="nf">StartService</span><span class="p">(</span><span class="kt">string</span> <span class="n">service</span><span class="p">,</span> <span class="kt">string</span> <span class="n">server</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">myService</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ServiceController</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">);</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">myService</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Stopped</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span><span class='line'>                <span class="n">myService</span><span class="p">.</span><span class="n">WaitForStatus</span><span class="p">(</span><span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Running</span><span class="p">);</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;\t{0} service Started in {1}. Current Status is {2}&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()));</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">myService</span><span class="p">.</span><span class="n">Status</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Comparing XML File Structure Without XSD]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/09/01/comparing-xml-file-structure-without-xsd/"/>
    <updated>2018-09-01T22:05:42+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/09/01/comparing-xml-file-structure-without-xsd</id>
    <content type="html"><![CDATA[<p>Code snippet for comparing two xml files without using xsd for validating their structure is same ( nodes and arguments should be same. Values of each node/argument can be different).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">internal</span> <span class="k">void</span> <span class="nf">VerifyMessageHaveSimilarStructureOfTemplate</span><span class="p">(</span><span class="kt">string</span> <span class="n">inputXml</span><span class="p">,</span> <span class="kt">string</span> <span class="n">templateXml</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">docA</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">docB</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">docA</span><span class="p">.</span><span class="n">LoadXml</span><span class="p">(</span><span class="n">inputXml</span><span class="p">);</span>
</span><span class='line'>            <span class="n">docB</span><span class="p">.</span><span class="n">LoadXml</span><span class="p">(</span><span class="n">templateXml</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="kt">var</span> <span class="n">isDifferent</span> <span class="p">=</span> <span class="n">DoTheyHaveDiferentStructure</span><span class="p">(</span><span class="n">docA</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">,</span> <span class="n">docB</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">);</span>
</span><span class='line'>            <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="s">&quot;Result of Checking for difference of Input xml with template is : &quot;</span> <span class="p">+</span> <span class="n">isDifferent</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">private</span> <span class="kt">bool</span> <span class="nf">DoTheyHaveDiferentStructure</span><span class="p">(</span><span class="n">XmlNodeList</span> <span class="n">xmlNodeListA</span><span class="p">,</span> <span class="n">XmlNodeList</span> <span class="n">xmlNodeListB</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">xmlNodeListA</span><span class="p">.</span><span class="n">Count</span> <span class="p">!=</span> <span class="n">xmlNodeListB</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">xmlNodeListA</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="kt">var</span> <span class="n">nodeA</span> <span class="p">=</span> <span class="n">xmlNodeListA</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>                <span class="kt">var</span> <span class="n">nodeB</span> <span class="p">=</span> <span class="n">xmlNodeListB</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">else</span>
</span><span class='line'>                        <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span> <span class="p">!=</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span> <span class="p">||</span> <span class="n">nodeA</span><span class="p">.</span><span class="n">Name</span> <span class="p">!=</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">AttributeNameA</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
</span><span class='line'>                <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">AttributeNameB</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
</span><span class='line'>                <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Name</span><span class="p">);</span>
</span><span class='line'>                    <span class="n">AttributeNameB</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">nodeB</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">Name</span><span class="p">);</span>
</span><span class='line'>                    <span class="c1">// -- If attribute position should be same, then include below as well</span>
</span><span class='line'>                    <span class="c1">//var attrA = nodeA.Attributes[j];</span>
</span><span class='line'>                    <span class="c1">//var attrB = nodeB.Attributes[j];</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">//if (attrA.Name != attrB.Name) return true;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">Sort</span><span class="p">();</span>
</span><span class='line'>                <span class="n">AttributeNameB</span><span class="p">.</span><span class="n">Sort</span><span class="p">();</span>
</span><span class='line'>                <span class="k">if</span><span class="p">(!</span> <span class="n">AttributeNameA</span><span class="p">.</span><span class="n">SequenceEqual</span><span class="p">(</span><span class="n">AttributeNameB</span><span class="p">))</span> <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">HasChildNodes</span> <span class="p">&amp;&amp;</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">HasChildNodes</span><span class="p">)</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">return</span> <span class="nf">HaveDiferentStructure</span><span class="p">(</span><span class="n">nodeA</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">,</span> <span class="n">nodeB</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">else</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Running API Test Using Cypress]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/05/27/running-api-test-using-cypress/"/>
    <updated>2018-05-27T08:03:28+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/05/27/running-api-test-using-cypress</id>
    <content type="html"><![CDATA[<p>Cypress is not just UI automation tool . It can be used for testing APIs as well . Even though we have other tools like Postman, Newman, Rest Assured, SOAP UI etc for testing APIs, I believe cypress is a good alternative for testing API. It will help to use same tool for both UI and API test automation.</p>

<h2>Demo</h2>

<p>Let us look at a sample API test case. In below example, we trigger a API call to <code>http://services.groupkt.com/country/get/iso2code/AU</code> and validate below in the response.</p>

<ul>
<li>Status code of response is 200.</li>
<li>Header include &lsquo;application/json&rsquo;.</li>
<li>Body contain &ldquo;Country found matching code [AU].&rdquo;</li>
</ul>


<p>We can then extend this to do any further checks if needed.</p>

<p>Create a new file inside <code>Integration</code> folder of cypress and copy below code into that.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>describe('API Testing with Cypress', () =&gt; {
</span><span class='line'>    var result
</span><span class='line'>    
</span><span class='line'>    it('Validate the header', () =&gt; {
</span><span class='line'>       result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>      
</span><span class='line'>       result.its('headers')
</span><span class='line'>             .its('content-type')
</span><span class='line'>             .should('include', 'application/json')
</span><span class='line'>        
</span><span class='line'>    })
</span><span class='line'>
</span><span class='line'>    it('Validate the status', () =&gt; {
</span><span class='line'>        result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>       
</span><span class='line'>        result.its('status')
</span><span class='line'>              .should('equal',200);
</span><span class='line'>     })
</span><span class='line'>
</span><span class='line'>     it('Validate the body ', () =&gt; {
</span><span class='line'>        result = cy.request('http://services.groupkt.com/country/get/iso2code/AU')
</span><span class='line'>       
</span><span class='line'>        result.its('body')
</span><span class='line'>              .its('RestResponse.messages')
</span><span class='line'>              .should('include', 'Country found matching code [AU].');
</span><span class='line'>      
</span><span class='line'>     })
</span><span class='line'>}) 
</span></code></pre></td></tr></table></div></figure>


<p>Open Cypress by running <code>node_modules/.bin/cypress open</code> inside cypress root folder. This will open up Cypress.</p>

<p>Run newly created test.</p>

<p><img src="http://www.abygeorgea.com/images/2018/05/27/01%20Run%20Test%20Case.png" alt="APITestingWithCypress" /></p>

<p>Results of test execution will look like below.</p>

<p><img src="http://www.abygeorgea.com/images/2018/05/27/02%20Check%20Result.png" alt="[APITestingWithCypress]" /></p>

<p>Expand each of them and right click on the asserts and inspect the element. This will open up chrome developer tool. Select the console tab , which will list down details of calls made, request received and assertions performed.  It will help to write additional assertions, investigate any failure etc.</p>

<p><img src="http://www.abygeorgea.com/images/2018/05/27/03%20Expand%20and%20Analyse%20result.png" alt="[APITestingWithCypress]" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[UI Automation With Cypress]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/05/11/ui-automation-with-cypress/"/>
    <updated>2018-05-11T07:31:39+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/05/11/ui-automation-with-cypress</id>
    <content type="html"><![CDATA[<p>When we talk about UI automation for browsers, the default tool which comes to mind is Selenium. There are different wrappers around selenium like protractor, Nightwatch , selenium webdriver etc. All of them are build on top of selenium and have all advantages /disadvantages of selenium. All of the control browser by executing remote commands through Network. We will most probably need additional libraries, framework etc to make full use of selenium.</p>

<p>Cypress.io is an open source UI automation tool which can be used for UI testing . Unlike others, this is not build on top of selenium . Instead is a complete new architecture and run in same run loop as browser. So it is running inside browser and have access to almost everything happening inside and outside browser. It is a complete set of tools that you will require to create and run E2E UI automation test cases. Team who developed cypress has made few design trade off which causes some disadvantages to cypress. There is no right tool for automation . It will depend on multiple factors.</p>

<h2>Installing Cypress</h2>

<p>We can install cypress using npm. Run below command inside project folder to install cypress and all dependencies.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install cypress --save-dev</span></code></pre></td></tr></table></div></figure>


<p>Another way of using cypress is to download zip file from <a href="https://www.cypress.io/features/">here</a> . Just extract the file and start using it.</p>

<h2>Opening Cypress</h2>

<p>Cypress can be opened by running <code>node_modules/.bin/cypress open</code> command in terminal under /cypress.</p>

<p>If you have downloaded the zip file, you can open cypress by double clicking on the cypress executable.</p>

<h2>Write your first test</h2>

<p>Cypress already come with predefined example of KitchenSink application which will help you to identify various commands which can be used. It can be found under <code>cypress\integration\example_spec.js</code>.</p>

<p>Let us look at how to write a new test .</p>

<p>Create a new test script file called <code>demotest.js</code> under <code>{project_location}\cypress\integration</code>. Open up the file and write below code into it.</p>

<p>This code will open browser, load google and search for cypress.io and open up the first link.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>describe('My first test for cypress', function() {
</span><span class='line'>    it('Visits google home page ', function() {
</span><span class='line'>      cy.visit('https://google.com');
</span><span class='line'>    })
</span><span class='line'>    it('should load the Google Homepage', () =&gt; {
</span><span class='line'>        cy.title().should('eql', 'Google');
</span><span class='line'>    })
</span><span class='line'>    it('should search and open cypress home page', () =&gt; {
</span><span class='line'>        cy.get('#lst-ib').type('cypress.io');
</span><span class='line'>        cy.get('[value="I\'m Feeling Lucky"]').focus().click();
</span><span class='line'>    })
</span><span class='line'>   
</span><span class='line'>   
</span><span class='line'>  })</span></code></pre></td></tr></table></div></figure>


<p>Note: If cross origin policy error is shown, flow the workarounds mentioned.</p>

<h2>How does cypress.io compare with Selenium</h2>

<p>As mentioned earlier, there is no right or wrong tool for automation. It all depends on suitability for the task on hand. Let us compare few features where cypress.io and selenium have differences.</p>

<ul>
<li>Cross browser support - At this point selenium have more cross browser support that cypress. Cypress supports only chrome variants. You can read about them <a href="https://github.com/cypress-io/cypress/issues/310">here</a></li>
<li>Debugging capability - This is high in cypress. I found that error message are more details and infact provide some more details about how to fix it. Also you have full access to chrome dev tools.</li>
<li>Keypress - As of now , cypress doesnt support pressing Tab key . You can read about it <a href="https://github.com/cypress-io/cypress/issues/299">here</a>.</li>
<li>Since cypress is build on node.js, we can chain commands together</li>
<li>Cypress.io have built in support for test framework and assertion libraries like mocha, chai etc</li>
<li>Cypress.io test cases can be written in Javascript</li>
<li>Cypress.io handles wait times better than selenium</li>
<li>Cypress.io have hot reloading of test cases. When we make changes to test cases and save it , the test rerun by itself. This is very effective to reduce time spend on building and rerunning selenium based test cases.</li>
<li>Cypress.io have built in time travel and screenshots which will help us to go back to failure points and debug. It also capture before and after state for all actions</li>
</ul>


<p>I will keep adding to this when I play more with cypress.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Writing Tests in Postman]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/05/03/writing-tests-in-postman/"/>
    <updated>2018-05-03T21:05:00+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/05/03/writing-tests-in-postman</id>
    <content type="html"><![CDATA[<p>In previous blog <a href="http://www.abygeorgea.com/blog/2018/04/28/postman-bdd/">post</a>, we saw how to use BDD format for writing test cases in postman. Most important part of writing tests in postman is understanding various features available. Let us explore various options available . The examples specified in postman <a href="https://documenter.getpostman.com/view/220187/postman-bdd-examples/6Z3uY71#30dfc9d2-5de4-b932-db3e-641c29fb0459">documentation</a>, have lot of information about how to setup postman bdd, use chai http assertions, create custom assertions and use before and after hooks. Please import them into postman and try that by yourself to familiarise with postman BDD. Below is only few examples from them.</p>

<p>Postman BDD makes use of Chai Assertion Library and Chai-Http. We have access to both libray and postman scripting environment for writing test cases. Chai has two types of assertion styles.</p>

<ul>
<li><code>Expect/should</code> for BDD</li>
<li><code>Assert</code> for TDD</li>
</ul>


<p>Both styles support chainable language to construct assertions. We can use both of them to write postman test assertions. If you need details of all chainable constructs, please refer to their <a href="http://www.chaijs.com/api/bdd/">documentation</a>. Major ones which we may use in postman tests are</p>

<ul>
<li><p>Chains</p>

<pre><code>  to
  be
  been
  is
  that
  which
  and
  has
  have
  with
  at
  of
  same
  but
  does
</code></pre></li>
<li><p>Not - Negates all conditions</p></li>
<li>any -</li>
<li>all -</li>
<li>inlcude</li>
<li>OK</li>
<li>true</li>
<li>false</li>
<li>null</li>
<li>undefined</li>
<li>exist</li>
<li>empty</li>
<li>match(re[, msg])</li>
</ul>


<p>Chai-Http module provide various assertions. Read through their documentation <a href="https://github.com/chaijs/chai-http#assertions">here</a> to know details. Below are main commands at our disposal for validation .</p>

<ul>
<li>.status(code)</li>
<li>.header (key[, value])</li>
<li>.headers</li>
<li>.ip</li>
<li>.json / .text / .html</li>
<li>.redirect</li>
<li>.param</li>
<li>.cookie</li>
</ul>


<p>Postman bdd provide <code>response</code> object on which we do most of assertions. It will have all information like response.text, response.body, response.status, response.ok , response.error. Postman BDD will automatically parse JSON and XML responses and hence there is no need to call JSON.parse() or xml2json(). response.text will have unparsed content. It also have automatic error handling , which will allow to continue with other test even if something fails.</p>

<p>Examples for various assertions done on response object are below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\\Verifying Header information
</span><span class='line'>expect(response).to.have.status(500);
</span><span class='line'>expect(response).to.have.header('x-api-key');
</span><span class='line'>expect(response).to.have.header('content-type', 'text/plain');
</span><span class='line'>expect(request).to.have.header('content-type', /^text/);
</span><span class='line'>expect(response).to.have.headers;
</span><span class='line'>expect('127.0.0.1').to.be.an.ip;
</span><span class='line'>
</span><span class='line'>\\Verifying Response body
</span><span class='line'>expect(response).to.be.json;
</span><span class='line'>expect(response).to.be.html;
</span><span class='line'>expect(response).to.be.text;
</span><span class='line'>
</span><span class='line'>response.should.have.status(200); 
</span><span class='line'>response.body.should.not.be.empty;
</span><span class='line'>response.ok.should.be.true;            // sucess with code 2XX
</span><span class='line'>response.error.should.be.true; //failures
</span><span class='line'>
</span><span class='line'>\\Verifying request
</span><span class='line'>expect(req).to.have.param('orderby', 'date');
</span><span class='line'>expect(req).to.not.have.param('orderby');
</span><span class='line'>expect(req).to.have.cookie('session_id', '1234');
</span><span class='line'>expect(req).to.not.have.cookie('PHPSESSID');
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>If we use above assertions in proper BDD format, it will look like below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>eval(globals.postmanBDD);
</span><span class='line'>describe('Example for Blog using SHOULD', function(){
</span><span class='line'>   it("Tests using SHOULD", function() {
</span><span class='line'>      response.should.have.status(200); 
</span><span class='line'>      response.should.not.be.empty;
</span><span class='line'>      response.should.have.header('content-type', 'application/json; charset=utf-8');
</span><span class='line'>      response.type.should.equal('application/json');
</span><span class='line'>      
</span><span class='line'>      var user = response.body.results[0];
</span><span class='line'>      user.name.should.be.an('object');
</span><span class='line'>      user.name.should.have.property('first').and.not.empty;
</span><span class='line'>      //user.name.should.have.property('first','david');
</span><span class='line'>      user.should.have.property('gender','male');
</span><span class='line'>   
</span><span class='line'>   
</span><span class='line'>   }) 
</span><span class='line'>})
</span><span class='line'>describe('Example for Blog using Expect', function(){
</span><span class='line'>   it("Tests using EXPECT", function() {
</span><span class='line'>      expect(response).to.have.status(200);
</span><span class='line'>      expect(response).not.empty;
</span><span class='line'>      expect(response).to.be.json;
</span><span class='line'>      expect(response).to.have.header('content-type', 'application/json; charset=utf-8');
</span><span class='line'>   }) 
</span><span class='line'>})
</span><span class='line'>
</span><span class='line'>it('should contain the un-parsed JSON text', () =&gt; {
</span><span class='line'>    response.text.should.be.a('string').with.length.above(50);
</span><span class='line'>    response.text.should.contain('"results":[');
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://www.abygeorgea.com/images/2018/05/03/postman%20bdd.png" alt="Postman" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Postman BDD]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/04/28/postman-bdd/"/>
    <updated>2018-04-28T07:46:43+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/04/28/postman-bdd</id>
    <content type="html"><![CDATA[<p>In Previous blog post,we discussed about <a href="http://www.abygeorgea.com/blog/2017/08/05/postman-tutorial/">how to use postman</a> and how to use <a href="http://www.abygeorgea.com/blog/2017/08/07/running-postman-collection-using-newman/">collections using newman </a>and <a href="http://www.abygeorgea.com/blog/2017/08/13/postman-using-data-file">data file</a>. If you haven&rsquo;t read that , please have a read through first .</p>

<p>In previous examples, we discussed about writing tests/assertions in postman. We followed normal Javascript syntax for writing test cases including asserting various factors of response ( like content , status code etc). Eventhough this is a straightforward way of writing, many people would like to use existing javascript test library like Mocha. They can use <a href="https://github.com/BigstickCarpet/postman-bdd/#installation">postman - bdd</a> libraries.</p>

<p>Let us take a deep dive into how to use setup postman bdd.</p>

<p>Note: It is assumed that user already have postman and newman installed on their machine along with their dependencies.</p>

<h2>Installing Postman BDD</h2>

<p>Installation is done triggering a Get request and setting the response as Global environment variable.</p>

<ul>
<li>Create a GET request to <code>http://bigstickcarpet.com/postman-bdd/dist/postman-bdd.js</code></li>
<li>Set Global environment variable by using below command in test tab. <code>postman.setGlobalVariable('postmanBDD', responseBody);</code></li>
</ul>


<p><img src="http://www.abygeorgea.com/images/2018/04/28/Installing%20Postman%20BDD.png" alt="PostManRequest" /></p>

<p>Once we trigger above get request, postman bdd will be available for use.  We can make use of postman BDD features by below command
<code>eval(globals.postmanBDD);</code></p>

<h2>Writing Tests</h2>

<p>Postman bdd library provide us with flexibility to write tests and assertions using fluent asserts and have best features of Chai and Mocha. Inorder to demonstrate this, I am using sample Tutorial given with postman client.</p>

<p>Open up the sample Request in Postman Tutorial folder under collections. It will already have some test predefined in Test tab. Remove them and add below test to it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>eval(globals.postmanBDD)
</span><span class='line'>//eval(postman.getGlobalVariable('postmanBDD'));
</span><span class='line'>var jsonData = JSON.parse(responseBody);
</span><span class='line'>describe('Testing Sample Request in Postman Tutorial', function () {
</span><span class='line'>  it('CASE 1: Should respond with statusCode = 200', function () {
</span><span class='line'>      response.should.have.status(200);
</span><span class='line'>  });
</span><span class='line'>  it('CASE 2: Should response time less than 500 ms', function () {
</span><span class='line'>      pm.response.responseTime.should.be.below(500);
</span><span class='line'>  });
</span><span class='line'>  it('CASE 3: User ID should be 1', function () {
</span><span class='line'>      jsonData.userId === 1;
</span><span class='line'>  });
</span><span class='line'>
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>Note: You can find more details of various type of asserts in <a href="http://www.chaijs.com/api/bdd/">http://www.chaijs.com/api/bdd/</a></p>

<p>Once it is done, trigger the request</p>

<p><img src="http://www.abygeorgea.com/images/2018/04/28/Postman%20BDD%20example.png" alt="PostManRequest" />.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gulp Task for Running Automated Test]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/03/20/gulp-task-for-running-automated-test/"/>
    <updated>2018-03-20T11:46:30+11:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/03/20/gulp-task-for-running-automated-test</id>
    <content type="html"><![CDATA[<p><a href="https://gulpjs.com/">Gulp</a> is a toolkit for automating painful or time-consuming task in your development workflow, so you can stop messing around and build something. Gulp can be used for creating a simple task to run automated test cases.</p>

<p>Firstly, we will create package.json file for this project. This can be done by below command from project folder. It will prompt you to enter a list of information required for creating package.json file</p>

<pre><code>npm init
</code></pre>

<p>Once this is done, install gulp.  It can be done by below command. This will add gulp as a dev dependency.</p>

<pre><code>npm install --save-dev gulp-install
</code></pre>

<p>In order to run acceptance test cases, we will need to install nunit/xunit test runners. It can be done by below command from the root folder.</p>

<pre><code>npm install --save-dev gulp-nunit-runner
        OR
npm install --save-dev gulp-xunit-runner
</code></pre>

<p>Detailed usage of above test runners are available <a href="https://www.npmjs.com/package/gulp-nunit-runner">here</a>.</p>

<p>Once above are installed, we need to create <code>gulpfile.js</code> inside root folder. This file will have details of various gulp tasks</p>

<p>Sample Usage of test runner is below. Insert this code into gulpfile.js</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var gulp = require('gulp'),
</span><span class='line'>    nunit = require('gulp-nunit-runner');
</span><span class='line'> 
</span><span class='line'>gulp.task('unit-test', function () {
</span><span class='line'>    return gulp.src(['**/*.Test.dll'], {read: false})
</span><span class='line'>        .pipe(nunit({
</span><span class='line'>            executable: 'C:/nunit/bin/nunit-console.exe',
</span><span class='line'>            options : {
</span><span class='line'>              where : 'cat == test'
</span><span class='line'>            }
</span><span class='line'>        }));
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>{read: false} means, it will read only file names and not the entire file.</li>
<li>Executable is the path to nunit console runner, which should be available.</li>
<li>gulp.src is that path to acceptance test solution dll. Since we use wild character, we may have to modify this path to reflect the exact path of dll.( something like ./**/Debug/Project.acceptancetest.dll)</li>
</ul>


<p>Once we have above in gulpfile.js, it can be run by below command</p>

<pre><code>gulp unit-test
</code></pre>

<p>Out of above command will be something like</p>

<pre><code>C:/nunit/bin/nunit-console.exe "C:\full\path\to\Database.Test.dll" "C:\full\path\to\Services.Test.dll"
</code></pre>

<p>Note: If it complains about assembly missing, it means path to acceptance test solution is incorrect . Retry after fixing the path.</p>

<p>Gulp Nunit runner provide lot options to configure test run, like selecting test cases based on category, creating output files etc. Detailed options can be found <a href="https://github.com/keithmorris/gulp-nunit-runner">here</a>.</p>

<p>Below is an example with few options</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var gulp = require('gulp'),
</span><span class='line'>    nunit = require('gulp-nunit-runner');
</span><span class='line'> 
</span><span class='line'>gulp.task('unit-test', function () {
</span><span class='line'>    return gulp.src(['**/*.Test.dll'], {read: false})
</span><span class='line'>        .pipe(nunit({
</span><span class='line'>            executable: 'C:/nunit/bin/nunit-console.exe',
</span><span class='line'>            options : {
</span><span class='line'>              where : 'cat == test',
</span><span class='line'>              work : 'TestResultsFolder',
</span><span class='line'>              result : 'TestResults.xml',
</span><span class='line'>              config : 'Debug'
</span><span class='line'>            }
</span><span class='line'>        }));
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Where - Selects the category which needs to be run</li>
<li>Work - Create a folder with specified path/name for output files</li>
<li>result - create test results in xml</li>
<li>config - select the config which needs to be run</li>
</ul>


<p>If we run <code>gulp unit-test</code> now, it will execute only the test cases having category <code>test</code>. It will create a folder named <code>TestResultsFolder</code> and will have an xml report of the test run inside it .  The folder will be created in root where we have gulpfile.js.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Extracting Metrics From TeamCity]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/03/01/extracting-metrics-from-teamcity/"/>
    <updated>2018-03-01T22:18:25+11:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/03/01/extracting-metrics-from-teamcity</id>
    <content type="html"><![CDATA[<p>TeamCity is a java based build management and continuous Integration server from JetBrains. Very often , we will have to extract various metrics from TeamCity for tracking and trend analysis.  TeamCity provides versatile api for extracting various metrics which can then be manipulated or interpreted as we need.</p>

<p>Below are basic api calls which can be used for extracting mertics. Please note that TeamCity api is powerful enough to do much more than extraction of data. However, for this blog post, I am focussing on metrics extraction part alone. All of these are GET request to TeamCity api with a valid user credentials ( use any id/password which can access TeamCity)</p>

<ol>
<li>Get List of Projects - <a href="http://teamcityURL:9999/app/rest/projects">http://teamcityURL:9999/app/rest/projects</a></li>
<li>Get details of a project - <a href="http://teamcityURL:9999/app/rest/projects/">http://teamcityURL:9999/app/rest/projects/</a>(projectlocator)
Project locator  can be either &ldquo;id:projectID&rdquo; or &ldquo;name:projectName&rdquo;</li>
<li>Get List of Build configuration - <a href="http://teamcityURL:9999/app/rest/buildTypes">http://teamcityURL:9999/app/rest/buildTypes</a></li>
<li>Get List of Build configuration for a project- <a href="http://teamcityURL:9999/app/rest/projects/">http://teamcityURL:9999/app/rest/projects/</a>(projectLocator)buildTypes</li>
<li>Get List of Build  - <a href="http://teamcityURL:9999/app/rest/builds/?locator=">http://teamcityURL:9999/app/rest/builds/?locator=</a>(buildLocator)</li>
<li>Get details of a specific Build  - <a href="http://teamcityURL:9999/app/rest/builds/">http://teamcityURL:9999/app/rest/builds/</a>(buildLocator)
Build locator can be &ldquo;id:BuildId&rdquo; or &ldquo;number:buildNumber&rdquo; Or a combination of these like &ldquo;id:BuildId,number:buildNumber,dimension3:dimensionvalue&rdquo;. We can use various different values for these dimension. Details can be found in TeamCity documentation</li>
<li>Get List of tests in a build - <a href="http://teamcityURL:9999/app/rest/testOccurrences?locator=build:">http://teamcityURL:9999/app/rest/testOccurrences?locator=build:</a>(buildLocator)</li>
<li>Get individual test history - <a href="http://teamcityURL:9999/app/rest/testOccurrences?locator=test:">http://teamcityURL:9999/app/rest/testOccurrences?locator=test:</a>(testLocator)</li>
</ol>


<p>Recently I created a Nodejs program to extract below metrics by chaining some of the above api calls.</p>

<ul>
<li>Number of builds between any two given dates and their status</li>
<li>Details of number of test cases and their status , pass percentage, fail percentage etc for each build</li>
<li>Details as above for entire period.</li>
<li>Trend of test progress, build failures etc between those dates</li>
<li>Create an output JSON with cumulative counts of passed/failed/ignored builds, passed/failed/ignored test cases , percentage of sucessful builds, frequency of pull request and their success rates etc.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automate Accessibility Testing Using aXe]]></title>
    <link href="http://www.abygeorgea.com/blog/2018/03/01/automating-accessibility-testing/"/>
    <updated>2018-03-01T21:30:32+11:00</updated>
    <id>http://www.abygeorgea.com/blog/2018/03/01/automating-accessibility-testing</id>
    <content type="html"><![CDATA[<h3>What is Accessibility testing ?</h3>

<p>It is a kind of testing performed to ensure application under test is usable by people with disabilities. One of the most common accessibility testing for web applications is to ensure it is easily usable by people with vision impairment. They normally use screen readers to read the screen and use key board to navigate.</p>

<p>Web Content Accessibility Guideline (WCAG) list down guidelines and rules for creating accessible website. There are various browser extensions and developer tools available for scanning web pages to find out obvious accessibility issues. aXe is one of the widely used extension. Details of aXe can be found <a href="https://www.deque.com/products/axe/">here</a>.  Once browser extension is installed, you can analyze any web page to find out accessibility issues. They also have a javascript API for aXe core .</p>

<p>I recently came across <a href="https://github.com/javnov/axe-selenium-csharp">axe-selenium-csharp</a> , which is a .NET wrapper around aXe. It is relatively very easy to setup and use.  Below are the steps</p>

<ol>
<li>Install Globant.Selenium.Axe nuget package for solution. This will add reference to dll</li>
<li>Import namespace <em>using Globant.Selenium.Axe</em></li>
<li>Call &ldquo;Analyze&rdquo; method to run accessibility check on the current page.</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">Globant.Selenium.Axe</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">PerformAccessbilityAudit</span><span class="p">(</span><span class="n">IWebDriver</span> <span class="n">_driver</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'> <span class="k">private</span> <span class="n">AxeResult</span> <span class="n">_results</span><span class="p">;</span>
</span><span class='line'> <span class="n">_results</span> <span class="p">=</span> <span class="n">_driver</span><span class="p">.</span><span class="n">Analyze</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">xyz</span> <span class="k">in</span> <span class="n">_results</span><span class="p">.</span><span class="n">Violations</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">xyz</span><span class="p">.</span><span class="n">Impact</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">xyz</span><span class="p">.</span><span class="n">Description</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                <span class="n">log</span><span class="p">.</span><span class="n">Info</span><span class="p">(</span><span class="n">xyz</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>  <span class="n">Assert</span><span class="p">.</span><span class="n">True</span><span class="p">(</span><span class="n">_results</span><span class="p">.</span><span class="n">Violations</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">,</span> <span class="s">&quot;There are accessibility violations. Please check log file&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Automated accessibility testing is NOT a completely foolproof solution. We will still require someone to scan the page using screen reader software later. But this will help to move accessibility testing to left and have more frequent runs and reduce the need for regression.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mountebank - Adding Delay to Response]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/11/16/mountebank-adding-delay-to-response/"/>
    <updated>2017-11-16T09:59:17+11:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/11/16/mountebank-adding-delay-to-response</id>
    <content type="html"><![CDATA[<p>In previous blog post, I have explained about how to create a json response in mountebank. You can read about that <a href="http://www.abygeorgea.com/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/">here</a> and <a href="http://www.abygeorgea.com/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">here</a>. Recently , I had to test a scenario about what will happen to application if downstream API response is delayed for some time . Let us have a look about how we can use mountebank to simulate this scenario.</p>

<p>Mountebank supports adding latency to response by adding a behaviour. You can read about that <a href="http://www.mbtest.org/docs/api/behaviors">here</a> . Let us try to implement the wait behaviour in one of the previous examples . This is a slight modification of the files used as part of examples mentioned <a href="http://www.abygeorgea.com/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-1/">here</a> and <a href="http://www.abygeorgea.com/blog/2017/04/07/mountebank-creating-a-response-based-on-a-file-template-and-modifying-it-based-on-request-part-2/">here</a>.  You can clone my github repo and look at &ldquo;ExamplesForWaitBehaviour&rdquo; for the files.</p>

<p>The only change which we need is to add a behavior to the response. This is added in &ldquo;CustomerFound.json&rdquo; file. After injecting file, we need to add behavior for waiting 5000 milliseconds.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>"responses": [
</span><span class='line'>{
</span><span class='line'>"inject": "&lt;%-stringify(filename, 'ResponseInjection\\GetCustomerFound.js') %&gt;",
</span><span class='line'>"_behaviors": {
</span><span class='line'>    "wait": 5000
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>],
</span><span class='line'>"predicates": [
</span><span class='line'>{
</span><span class='line'>"matches": {
</span><span class='line'>"method" : "GET",
</span><span class='line'>"path" : "/Blog.Api/[0-9]+/CustomerView"
</span><span class='line'>}
</span><span class='line'>}
</span><span class='line'>]
</span></code></pre></td></tr></table></div></figure>


<p>Now run Mountebank. If you are using the GitHub repo, you can do this by running RunMounteBankStubsWithExampleForWait.bat file. Else run below command inside the directory where mountebank is available. If needed, modify the path to Imposter.ejs as required.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mb --configfile ExamplesForWaitBehaviour/Imposter.ejs --allowInjection</span></code></pre></td></tr></table></div></figure>


<p>When we trigger a request via postman, we will get a response after specified delay + time for getting a response.  Have a look at response time in below screenshot. Response time is more than 5000 ms.</p>

<p><img src="http://www.abygeorgea.com/images/2017/11/16/Mountebank_Adding_Delay_PostmanRequest1.png" alt="PostManRequest" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Highlights of Past One Month]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/10/24/blog-traffic/"/>
    <updated>2017-10-24T21:32:10+11:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/10/24/blog-traffic</id>
    <content type="html"><![CDATA[<p>I was not active in this blog over past one month due to multiple reasons - both personal and professional. Following are some highlights over past one month.</p>

<h3>ISTQB Test Automation Engineer</h3>

<p>As mentioned in previous <a href="http://www.abygeorgea.com/blog/2017/08/29/anztb-sigist-conference/">post</a>, I had a chance to attend ANZTB SIGiST conference in August 2017. There were some good talks about various certifications offered by ISTQB/ANZTB.  ISTQB <a href="http://www.anztb.org/advancedlevel.php">Test Automation Engineer</a> was one among them. I decided to give that a try . Spend some time over past one month to prepare based on the syllabus and I gave it a shot. Fortunately, I passed the exam with good marks</p>

<h3>Traffic to  blog</h3>

<p>I had an interesting observation when I looked into google analytics for the blog. The traffic to this blog has grown over ten times compared to previous months. I analyzed the data and found that my blog and <a href="https://github.com/abygeorgea/MountebankExamples">github repo</a> for mountebank examples are mentioned in <a href="http://www.mbtest.org/docs/examples">mountebank website</a>. This resulted in having more traffic to the blog. I hope others are also benefitted from my experience with mountebank and the tutorial which I have in this blog. Hopefully, this will give me the motivation to write more.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Taking Emotions Out of Sprint Retrospective]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/09/22/taking-emotions-out-of-sprint-retrospective/"/>
    <updated>2017-09-22T21:14:25+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/09/22/taking-emotions-out-of-sprint-retrospective</id>
    <content type="html"><![CDATA[<p>An agile retrospective is a meeting held at end of a sprint to analyse their ways of working over past sprint and identify how to become more effective and then adjust accordingly. This is a ritual which belongs to team and criticism is given for facts/output and not for people. Retrospective creates an environment where the team feels safe and comfortable, which will allow them to talk freely about their thoughts and let go their frustration.</p>

<p>As an agile team, our team was pretty matured. Everyone knows what to do and what not to do. They come with solutions for most of the impediments faced during the sprint . Even then, there will be few issues which are still not resolved. Often retrospective meetings end up being a place for the team to let out their frustration rather than focusing on identifying what worked well and what could have been done better. Also action items coming out of discussion may be already tried out during sprint and was not working as expected.</p>

<p>Last week, I had a chance to run retrospective for the team. I wanted to focus more on proactive actions taken by the team while dealing with impediments. I decided to run a different retro in which I tried to keep emotions out and focus more on facts.</p>

<h3>Goals of this retrospective</h3>

<p>Hope below exercise will help to achieve :</p>

<ul>
<li>Take emotions out of discussion and focus on facts</li>
<li>Review the actions taken by team during sprint and asses its effectiveness</li>
<li>Identify improvements which were not tried out during sprint</li>
</ul>


<h3>How to do it</h3>

<h6>Sprint Goals</h6>

<ul>
<li>First step is to identify the sprint goals and write it down on board for everyone to see. This reminds the team about their every day work to achieve the goals.</li>
</ul>


<h6>Negatives</h6>

<ul>
<li>Next step is to identify the risk, issues and blockers which prevented the team from achieving it. It can be anything which team found as an impediment.</li>
<li>Each team member has to write down a unique impediment on a card. Hence for a team of 10 members, you will have 10 unique impediments.</li>
<li>Team will then rate the impediments on a scale of 1 - 10. Where 1 being least and 10 is a complete blocker.</li>
<li>Once that is done, cards are exchanged with team members.</li>
</ul>


<h6>Positives</h6>

<ul>
<li>Next person will then have to think about what all good ideas happened for impediment on their card ( written by someone else). It can be anything which team has tried to overcome the blockers, any innovative ideas tried out, usage of extra time for learning and development etc. Team members are free to discuss this with others to find out all positives of that issue.</li>
<li>Once it is written, team member will rate it on a scale of 1 - 10. On practical world, the rating for positives will be less than the rating for negatives.  Else, it will not be an impediment to start with.</li>
</ul>


<h6>Actions</h6>

<ul>
<li>Now facilitator has to collect back all cards and look for three cards having a maximum difference between negative and positive ratings.</li>
<li>By end of this, team will have three pressing impediments which they could not overcome in the sprint. It takes into account of all pro-active actions taken by the team while dealing with that specific impediments. It is also based on facts and collective feedback .</li>
<li>Now it is time to discuss and come up with action items. Obviously new action items coming out of discussion should be new and was not tried earlier.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting Right Expectation About Benefits of Test Automation]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/09/07/test-automation/"/>
    <updated>2017-09-07T22:42:15+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/09/07/test-automation</id>
    <content type="html"><![CDATA[<p>Today I had a discussion with a project manager about stake holder expectations about value delivered from regression test automation and how to manage stake holder expectation. The discussion soon spanned on to challenges in automating manual test cases and candidates for automation testing.</p>

<h3>Expectation Vs Reality</h3>

<p>Management Stakeholders always visualize test automation as a silver bullet for fixing all pain points.They envision automation tests to be quicker, cheaper and effective in identifying all defects. Automation test cases are expected to be run on a button click and with 100% pass rate (except for valid bugs). Needless to say, that expectation is about having complete test coverage for automation scripts. Thinking is always geared towards reducing manual testers based on automation progress rather than having focus on improved quality of final product, faster time to market etc.</p>

<p>The ground reality is different from above expectation. Automated test cases are only as good as how you script it to be. Automated checks will alert tester about problems that checks have been programmed to detect.It ignores all other problems outside of it. Cost, speed, and ROI will depend on the tool used and complexity of tests implemented.   Having an automated test is not a replacement for doing exploratory test manually. We need to cater for manual exploratory testing since automated scripts can only do verification of already known check points( for which the coding is done) and miss out check points which are not automated. In other words, test automation frees up tester&rsquo;s time to focus more on exploratory testing which adds value.</p>

<p>Challenge in this specific case is to automate E2E manual regression test cases which are not existing. The testers are supposed to identify the regression test cases first by going to through existing application and then automate them. The expectation is that testers will identify all possible error scenarios and incorporate corresponding checks in automated scripts. This is going to be time consuming and expensive. It depends on domain knowledge of the person who creates automation test cases. There are chances that all existing bugs will be considered as an expected behaviour. More over the end to end test cases done at UI level is generally time consuming to develop, slow to execute and heavily depended on UI which makes it brittle.</p>

<h3>Testing Pyramid</h3>

<p>Solution to improve quality of a product is to follow the <a href="https://martinfowler.com/bliki/TestPyramid.html">testing pyramid</a> and try to automate more at lower levels instead of focussing at E2E level.  This also has to be done while the product/software is developed.</p>

<p>Below is a modified version of testing pyramid.</p>

<p><img src="http://www.abygeorgea.com/images/2017/09/07/TestingPyramid.jpg" alt="" /></p>

<p>As you can see above, more emphasis is given to have automated test at Unit test level, followed by component level, integration test level, and finally E2E level through UI.  It is relatively cheaper to implement automated test at the base of the pyramid and will get more expensive as we go up. Similarly, unit tests are faster to run, it can isolate issues immediately and are more stable. These characteristics will change adversely as we go up in test pyramid.</p>

<p>As obvious, it is not feasible to achieve this for an already existing system without having a significant investment in people, time and tools. This will impact ROI. Depending on situations, there is no right or wrong way to do test automation. Having something is always better than nothing. Hence when there is a need to automate regression test cases, it normally starts from the top.  Significant investment is needed upfront to identify all critical regression test cases and corresponding validation that should be performed by automated tests. It is not feasible to automate all test or to have 100% coverage. Success rates of automation script run will depend on various factors like test data, environment stability etc. Everyone should understand that we are automating check point verifications and hence it does trigger alerts only for the checks which it is programmed to do. E2E regression through UI should be only a minimal subset of what is covered through other levels. We should be ready to invest in maintaining the automation assets over a period of time.</p>

<p>In this case, stakeholder expectation needs to be carefully managed. It is important to set right expectation about benefits offered by test automation for a successful project delivery. Automation testing can deliver benefits over a long period of time , provided proper planning was done upfront to automate at different levels of testing. Instead of considering it as solution for all pain points, we need to clearly articulate /set expectation about its limitations and long term benefits.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ANZTB SIGiST Conference]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/08/29/anztb-sigist-conference/"/>
    <updated>2017-08-29T21:32:28+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/08/29/anztb-sigist-conference</id>
    <content type="html"><![CDATA[<p>Today, I had a chance to attend SIGiST conference organised by ANZTB. It was a 2-hour session which includes a presentation, discussion, and networking opportunities. Being a first-time attendee to SIGiST, I was not sure what surprise I may have. Overall it was a fruitful session and I had a chance to meet people from other organisation and to understand what is happening at their end.</p>

<p>Today&rsquo;s presentation was about &ldquo;Test Automation  What YOU need to know&rdquo;. Over all, it was a good session even though I found the presentation is more geared towards uplifting manual testers and what steps they should take to stay relevant in today&rsquo;s world. Going by crowd surrounding presenters after the session, it seems topic was well received and resonated with most of the people in the room. But those who have experience in automation / performance testing will find it basic. The presentation is expected to be uploaded <a href="http://www.anztb.org/downloads.php">here</a> in few days.</p>

<p>The topic for discussion was &ldquo;Carriers in Testing&rdquo;. This was really engaging and people participated actively sharing their experiences in career progression, experience in getting jobs etc. There was pretty lengthy discussion about how to make your resume stand out in the crowd, importance of certification, soft skill, analyticall and debugging skills and how to market yourself. Few recruiters/managers shed thoughts on what they look in prospective employee&rsquo;s resume and how they short list candidates for interview.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Postman - Using Data File]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/08/13/postman-using-data-file/"/>
    <updated>2017-08-13T20:56:01+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/08/13/postman-using-data-file</id>
    <content type="html"><![CDATA[<p>One of the common requirement for automated testing is to run same test case against multiple test data. Luckily postman supports this by providing facility to use data files. This is available only when we run through postman collection runner or newman.</p>

<p>For this example, let us take a free public API <code>http://services.groupkt.com/country/get/iso2code/AU</code> . This API will return the name of the country depending on the 2 digit code passed. Let us assume that, we need to test this API with multiple country codes. For eg: AU, IN, GB etc.  Let us take a look to see how this can be achieved using postman data files.</p>

<h4>Environment file</h4>

<p>First, create an enviornment Manage Environment option at top right. Create an entry for endpoint as below.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%201.png" alt="EnivironmentSetup" /></p>

<h4>Create Collection</h4>

<p>Next step is to create a collection with a GET request and write tests to verify the response. GET request used here is <code>{EndPoint}/country/get/iso2code/{countrycode}</code></p>

<p>Endpoint is defined in environment file and countrycode will be in data file</p>

<p>Now write some tests to check the results. The data coming from data file will be available under &ldquo;data&rdquo; dictionary  ( similar to global/environment variable. It can be accessed as <code>data.VARIABLENAME</code> or <code>data["VARIABLENAME"]</code> in both test and pre requisite scripts. Below screenshot shows the test which is for validating country name based on the data file.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%202.png" alt="EnivironmentSetup" /></p>

<h4>DateFile</h4>

<p>Postman supports both CSV and JSON format. For CSV files, the first row should be the variable names as the header. All subsequent rows are data row. JSON file should be an array of the keyvalue pair where the variable name is the key.</p>

<p>Data file used in this example is below. It has 3 column, where the first column is test case ID and the second one is country code which is used in the request and the third one is the country name, which is used for asserting the response received. In this example, I am looking for 3 different country codes.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%203.png" alt="datafile" /></p>

<h4>Running Collections</h4>

<p>While running collections, we need to specify below inputs.</p>

<ul>
<li>Collection Name</li>
<li>Environment file</li>
<li>Data File</li>
</ul>


<p>Depending on number of records in the data file, iterations will be auto populated. The results will also show the details for each iteration using the data. Details of response can be found by expanding response body</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%204.png" alt="collection" /></p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%205.png" alt="result" /></p>

<h4>Running through Newman</h4>

<p>We can run same collection through Newman as well</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>newman run PathToCollectionsFile -e PathToEnvironmentFiles -d PathToDataFile
</span></code></pre></td></tr></table></div></figure>


<p>In this cases, I should run <code>newman run DataDriven.postman_collection.json -e DataDrivenEnvironment.postman_environment.json   -d data-article.csv</code>.</p>

<p>Results will be as below</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/13/PostmanDatafile%206.png" alt="NewmanResults" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Running Postman Collection Using Newman]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/08/07/running-postman-collection-using-newman/"/>
    <updated>2017-08-07T15:46:28+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/08/07/running-postman-collection-using-newman</id>
    <content type="html"><![CDATA[<p>In previous <a href="http://www.abygeorgea.com/blog/2017/08/05/postman-tutorial/">blog</a>, I explained about how to create a GET request, analyze its response, write test cases for API and to save details to a collection for future use. In this blog, let me explain about how to run collections using Newman.</p>

<h3>What is Newman</h3>

<p>Newman is a command line collection runner for postman. Newman also has feature parity with Postman and it runs collection in the same way how it is run through Postman. Newman also makes it easier to integrate API test case execution with other systems like Jenkins.</p>

<h3>Installing Newman</h3>

<p>Newman is built on Node.js and hence it requires Node.js to be installed as prerequisite. Newman can be installed from npm with below command</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ npm install -g newman</span></code></pre></td></tr></table></div></figure>


<h3>Running collection using Newman</h3>

<p>Collections are executed by calling run command in Newman. Basic command for executing collections is</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>newman run PathToCollectionFile -e PathToEnvironmentFileIfAny</span></code></pre></td></tr></table></div></figure>


<p>Below is an example of running collections created in previous blog post using newman.
Command will look like below
<code>newman run /Users/abygeorgea/Projects/Postman/Postman\ Tutorial.postman_collection.json -e /Users/abygeorgea/Projects/Postman/Test.postman_environment.json</code></p>

<h3>Results</h3>

<p>The result of API test case execution will look like below. It has a detailed report of number of iterations, number of request, test scripts, pre-requisites, assertions etc. As per standard, passed ones are shown in green and failed in red. The results look similar to details provided if collections are executed using postman.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/07/Newman%201.png" alt="NewmanResult" /></p>

<h3>Additional Options of run command</h3>

<p>Newman has various options to customize run. Different options can be found by running with <code>-h</code> flag</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>newman run -h</span></code></pre></td></tr></table></div></figure>


<p>Different options listed are below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Abys-MacBook-Pro:~ abygeorgea$ newman run -h
</span><span class='line'>usage: newman run [-h] [-v VERSION] [--no-color] [--color]
</span><span class='line'>                  [--timeout-request TIMEOUT_REQUEST] [--ignore-redirects]
</span><span class='line'>                  [-k] [--ssl-client-cert SSL_CLIENT_CERT]
</span><span class='line'>                  [--ssl-client-key SSL_CLIENT_KEY]
</span><span class='line'>                  [--ssl-client-passphrase SSL_CLIENT_PASSPHRASE]
</span><span class='line'>                  [-e ENVIRONMENT] [-g GLOBALS] [--folder FOLDER]
</span><span class='line'>                  [-r REPORTERS] [-n ITERATION_COUNT] [-d ITERATION_DATA]
</span><span class='line'>                  [--export-environment [EXPORT_ENVIRONMENT]]
</span><span class='line'>                  [--export-globals [EXPORT_GLOBALS]]
</span><span class='line'>                  [--export-collection [EXPORT_COLLECTION]]
</span><span class='line'>                  [--delay-request DELAY_REQUEST] [--bail] [-x] [--silent]
</span><span class='line'>                  [--disable-unicode] [--global-var GLOBAL_VAR]
</span><span class='line'>                  collection
</span><span class='line'>
</span><span class='line'>The "run" command can be used to run Postman Collections
</span><span class='line'>
</span><span class='line'>Positional arguments:
</span><span class='line'>  collection            URL or path to a Postman Collection
</span><span class='line'>
</span><span class='line'>Optional arguments:
</span><span class='line'>  -h, --help            Show this help message and exit.
</span><span class='line'>  -v VERSION, --version VERSION
</span><span class='line'>                        Display the newman version
</span><span class='line'>  --no-color            Disable colored output
</span><span class='line'>  --color               Force colored output (for use in CI environments)
</span><span class='line'>  --timeout-request TIMEOUT_REQUEST
</span><span class='line'>                        Specify a timeout for requests (in milliseconds)
</span><span class='line'>  --ignore-redirects    If present, Newman will not follow HTTP Redirects
</span><span class='line'>  -k, --insecure        Disables SSL validations.
</span><span class='line'>  --ssl-client-cert SSL_CLIENT_CERT
</span><span class='line'>                        Specify the path to the Client SSL certificate. 
</span><span class='line'>                        Supports .cert and .pfx files.
</span><span class='line'>  --ssl-client-key SSL_CLIENT_KEY
</span><span class='line'>                        Specify the path to the Client SSL key (not needed 
</span><span class='line'>                        for .pfx files).
</span><span class='line'>  --ssl-client-passphrase SSL_CLIENT_PASSPHRASE
</span><span class='line'>                        Specify the Client SSL passphrase (optional, needed 
</span><span class='line'>                        for passphrase protected keys).
</span><span class='line'>  -e ENVIRONMENT, --environment ENVIRONMENT
</span><span class='line'>                        Specify a URL or Path to a Postman Environment
</span><span class='line'>  -g GLOBALS, --globals GLOBALS
</span><span class='line'>                        Specify a URL or Path to a file containing Postman 
</span><span class='line'>                        Globals
</span><span class='line'>  --folder FOLDER       Run a single folder from a collection
</span><span class='line'>  -r REPORTERS, --reporters REPORTERS
</span><span class='line'>                        Specify the reporters to use for this run.
</span><span class='line'>  -n ITERATION_COUNT, --iteration-count ITERATION_COUNT
</span><span class='line'>                        Define the number of iterations to run.
</span><span class='line'>  -d ITERATION_DATA, --iteration-data ITERATION_DATA
</span><span class='line'>                        Specify a data file to use for iterations (either 
</span><span class='line'>                        json or csv)
</span><span class='line'>  --export-environment [EXPORT_ENVIRONMENT]
</span><span class='line'>                        Exports the environment to a file after completing 
</span><span class='line'>                        the run
</span><span class='line'>  --export-globals [EXPORT_GLOBALS]
</span><span class='line'>                        Specify an output file to dump Globals before exiting
</span><span class='line'>  --export-collection [EXPORT_COLLECTION]
</span><span class='line'>                        Specify an output file to save the executed collection
</span><span class='line'>  --delay-request DELAY_REQUEST
</span><span class='line'>                        Specify the extent of delay between requests 
</span><span class='line'>                        (milliseconds)
</span><span class='line'>  --bail                Specify whether or not to gracefully stop a 
</span><span class='line'>                        collection run on encountering the first error
</span><span class='line'>  -x, --suppress-exit-code
</span><span class='line'>                        Specify whether or not to override the default exit 
</span><span class='line'>                        code for the current run
</span><span class='line'>  --silent              Prevents newman from showing output to CLI
</span><span class='line'>  --disable-unicode     Forces unicode compliant symbols to be replaced by 
</span><span class='line'>                        their plain text equivalents
</span><span class='line'>  --global-var GLOBAL_VAR
</span><span class='line'>                        Allows the specification of global variables via the 
</span><span class='line'>                        command line, in a key=value format</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Postman Tutorial]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/08/05/postman-tutorial/"/>
    <updated>2017-08-05T07:09:48+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/08/05/postman-tutorial</id>
    <content type="html"><![CDATA[<p>Recently one of my colleagues has asked me to train him on using postman and Newman for API testing. Below is a cut down version of training session which I took for him.</p>

<h3>What is Postman</h3>

<p>Postman is an Http client for testing web services. It has a friendly GUI for constructing request and analyzing the response. There is a command line tool called Newman for running the postman collections from command line. This will help to integrate postman to other testing tools.</p>

<h3>How to Install</h3>

<p>Postman is available as both chrome extension and also as a native install. Native install files can be found <a href="https://www.getpostman.com/apps">here</a>.</p>

<h3>Example - GET Request</h3>

<p>In order to trigger a get request, we need to identify below information</p>

<ul>
<li>URL of API</li>
<li>Authentication details</li>
<li>Header details</li>
</ul>


<p>For this example, let us look at a google finance API.  API URL(including parameters) is <a href="http://www.google.com/finance/info?infotype=infoquoteall&amp;q=NSE:BHEL">http://www.google.com/finance/info?infotype=infoquoteall&amp;q=NSE:BHEL</a>
There is no authentication details and header details that need to be passed with this. The <code>params</code> button will list down various parameters passed in a tabular format , which makes it easy to edit.</p>

<p>In postman, Select drop down as <code>GET</code> and enter the API Url. Screen will look like below
<img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%201.png" alt="Request" /></p>

<p>Now hit <code>Send</code> button. This will trigger a call to API and get the response which will then displayed in UI. Screen will look like below</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%202.png" alt="Body" /></p>

<p>Headers returned are</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%203.png" alt="Headers" /></p>

<h3>Writing Tests</h3>

<p>Above is an example of calling an API and analyzing its response. Postman also has a facility to write test cases to verify the response. Test cases are written in javascript. Tests are run after the request is sent and it will allow access to response objects. The editor also provides commonly used code snippets which make it easier to write test.</p>

<p>The Below example is written for calling one of free API mentioned <a href="https://jsonplaceholder.typicode.com">here</a>.
In this example, we have test scripts for checking status code, values in the header, values in response, response time. We can even expand the test cases to complex verifications by writing javascript tests.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%204.png" alt="Tests" /></p>

<p>We notice following from above screenshot,</p>

<ul>
<li>6 test cases written on the top part to check for the status code, response time, header and response.</li>
<li>The response received on the bottom part.</li>
<li>Test tab shows that 6/6 test cases are passed ( in Green).</li>
</ul>


<p> Now let us dive into details of the test results. Below screenshot shows details of test cases and their status.</p>

<p> <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%205.png" alt="Test Result" /></p>

<h3>Collections</h3>

<p>We can save the current request and it associated tests ( if any) for future use in postman. It can also be exported and shared with others. Select option as <code>Save As</code> from drop down next to <code>Save</code>. We can specify request name, provide a description and select a folder and sub folder to save the response.</p>

<p> <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%206.png" alt="Collections" /></p>

<p> Once saved, it will be available for use in collections.</p>

<p>  <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%207.png" alt="Collections" /></p>

<h3>Environments</h3>

<p>Very frequently, we will have to run API test in different environments. Most of the time, there will be few differences in the requests, like different URL. In such cases, we can use environments in Postman.</p>

<p>Click on the Settings button on top right corner and select <code>Manage environments</code>. This is open up a new pop up where we can add Environment or import an existing environment file. For this tutorial, we will use Add option.</p>

<p>  <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%208.png" alt="Environment" /></p>

<p> Now we can specify all unique parameter for each environment. In this case, I have given a key called &ldquo;URL&rdquo; and entered corresponding values and saved it as an environment named <code>Test</code>.</p>

<p> <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%209.png" alt="Environment" /></p>

<p> <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2010.png" alt="Environment" /></p>

<p> Now let us run the request using environments. First step is to replace <code>https://jsonplaceholder.typicode.com</code> with <code>url</code> in double curly braces. Then select <code>Test</code> in the Environment drop down at the top. Now click send. This will execute the request and run all associated test cases. Postman will dynamically replace  with corresponding URL value specified in selected environment file. So assuming we have different environment files, each time the request will be sent to different URL based on environment selected. We can have any number of keys and values in one environment file.</p>

<p>  <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2011.png" alt="Environment" /></p>

<p>  From above, we can see that one test case is failed. Let us have a look into failed test case.</p>

<p>   <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2012.png" alt="Environment" /></p>

<p>  Failed test case is for the time taken for the response. Current request took 1491 ms which is higher than expected 200ms.</p>

<h3>Exporting Collections and environment files</h3>

<p>Postman provides facility to export collections and environment files as JSON. This helps to share the details with other team members and also to use Newman for running postman collections. Let us have a look into how to export them.</p>

<p><strong>Exporting Collections</strong></p>

<ul>
<li>Click on Collections Tab.</li>
<li>Click on <code>...</code> next to Collections Name.</li>
<li>Click on Export.</li>
<li><p>Select V2 option and save the file.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2013.png" alt="Collection" /></p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2014.png" alt="Collection" /></p></li>
</ul>


<p><strong>Exporting Environment File</strong></p>

<ul>
<li>Click on Settings button on top right corner.</li>
<li>Click on Manage environment.</li>
<li><p>Download the file.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2015.png" alt="Export" /></p></li>
</ul>


<h3>Running Collections Using Postman Collection Runner</h3>

<p>Postman provides a feature to run collections using collection Runner.</p>

<ul>
<li>Click on Runner button on Top left to open collection runner</li>
<li><p>Select Collection name in drop down and select environment and then hit <code>Start Run</code>.</p>

<p><img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2016.png" alt="Collection Runner" /></p></li>
</ul>


<p>This will trigger execution of request and test cases mentioned in collection and results will be shown. Also note that collection runner has additional options like number of iteration, delay before sending request , input from data file etc .</p>

<p>Once execution is complete, result will be shown like below. It will have details of all assertions done and options to export results for future verification.
  <img src="http://www.abygeorgea.com/images/2017/08/05/Postman%20Tutorial%2017.png" alt="Collection Runner" /></p>

<h3>What Next ?</h3>

<p>In this post, I have explain basic usage of postman for API testing . However the functionalities provided by postman is much more than above. We can also use Newman , which is command line collection runner , to execute collections. I will write another post about it sometime soon.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Extracting Substring Using Javascript]]></title>
    <link href="http://www.abygeorgea.com/blog/2017/07/21/extracting-substring-using-javascript/"/>
    <updated>2017-07-21T06:09:53+10:00</updated>
    <id>http://www.abygeorgea.com/blog/2017/07/21/extracting-substring-using-javascript</id>
    <content type="html"><![CDATA[<p>In previous blogs <a href="http://www.abygeorgea.com/blog/2017/04/27/stubbing-xml-responses-using-mountebank/">here</a> , I have explained how we return a XML response using mountebank. However , most of the time, we will have to make some modification to the template response before returning a response. Say for example, we may have to replace details like timestamp, or use an input from request parameter and update that in response etc.</p>

<p>One of the easiest way to do this without using other frameworks like xml2js etc is to extract the substring between the node values and replace it . Below is a code snippet which will help to achieve this</p>

<p>The sample xml which we need to return is</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;Status&gt;Added&lt;/Status&gt;
</span><span class='line'>&lt;GeneratedID&gt;12345&lt;/GeneratedID&gt;</span></code></pre></td></tr></table></div></figure>


<p>In above example, assume that we need to replace the inserted record value every time based on the request coming through . We can do that by below</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">xmldata</span> <span class="o">=</span> <span class="s2">&quot;&lt;Status&gt;Added&lt;/Status&gt;\r\n&lt;GeneratedID&gt;12345&lt;/GeneratedID&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">generatedId</span> <span class="o">=</span> <span class="nx">xmldata</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;&lt;GeneratedID&gt;&quot;</span><span class="o">+</span><span class="s2">&quot;(.*)&quot;</span><span class="o">+</span><span class="s2">&quot;&lt;/GeneratedID&gt;&quot;</span><span class="p">));</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">generatedId</span><span class="p">);</span>
</span><span class='line'><span class="c1">// Output will be as below. from Array we can extract the substring, index of its location etc</span>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm">[ &#39;&lt;GeneratedID&gt;12345&lt;/GeneratedID&gt;&#39;,</span>
</span><span class='line'><span class="cm">  &#39;12345&#39;,</span>
</span><span class='line'><span class="cm">  index: 24,</span>
</span><span class='line'><span class="cm">  input: &#39;&lt;Status&gt;Added&lt;/Status&gt;\r\n&lt;GeneratedID&gt;12345&lt;/GeneratedID&gt;&#39; ]</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//so extract data from first location to get substring  </span>
</span><span class='line'><span class="nx">generatedId</span> <span class="o">=</span> <span class="nx">xmldata</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;&lt;GeneratedID&gt;&quot;</span><span class="o">+</span><span class="s2">&quot;(.*)&quot;</span><span class="o">+</span><span class="s2">&quot;&lt;/GeneratedID&gt;&quot;</span><span class="p">))[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">generatedId</span><span class="p">);</span>
</span><span class='line'><span class="c1">//Above will print &quot;12345&quot; , which is the expected value</span>
</span><span class='line'><span class="c1">// This can be used for extracting value of xml nodes</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//if we need to replace this with another value ( possibly coming from request parameter)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">xmldata</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">generatedId</span><span class="p">,</span> <span class="s2">&quot;99999&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
</feed>
